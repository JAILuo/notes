
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://jailuo.github.io/notes/Language/C_asm/lcthw%20ex26%20note/Brief%20description.html">
      
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.48">
    
    
      
        <title>Brief description - Messy Notes</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../css/timeago.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#brief-description" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../index.html" title="Messy Notes" class="md-header__button md-logo" aria-label="Messy Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Messy Notes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Brief description
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256l137.3-137.4c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/JAILuo/notes" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../index.html" title="Messy Notes" class="md-nav__button md-logo" aria-label="Messy Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Messy Notes
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/JAILuo/notes" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    首页
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Article
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Article
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="/article/concurrency sumary/summary.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    concurrency-summary
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="/article/toolchain/toolchain.mc" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    toolchain
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="/article/mount/mount.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mount
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Course
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Course
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    University Course
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            University Course
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1_1" id="__nav_3_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    jyy OS2024
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1">
            <span class="md-nav__icon md-icon"></span>
            jyy OS2024
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1_1_1" id="__nav_3_1_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    course note
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_1">
            <span class="md-nav__icon md-icon"></span>
            course note
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Course/University%20Course/jyy%20OS2024/cousre%20note/1.%20introduction/introduction.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Course/University%20Course/jyy%20OS2024/cousre%20note/2.%20concurrency/concurrency.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    concurrency
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Course/University%20Course/jyy%20OS2024/cousre%20note/3.%20virtualization/virtualization.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    virtualization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Course/University%20Course/jyy%20OS2024/cousre%20note/4.%20kernel/kernel.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kernel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Course/University%20Course/jyy%20OS2024/cousre%20note/5.%20persistence/persistence.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    persistence
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_2" >
        
          
          <label class="md-nav__link" for="__nav_3_1_1_2" id="__nav_3_1_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Mini Labs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_2">
            <span class="md-nav__icon md-icon"></span>
            Mini Labs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Course/University%20Course/jyy%20OS2024/Mini%20Labs/M1/M1.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    M1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Course/University%20Course/jyy%20OS2024/Mini%20Labs/M2/M2.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    M2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Course/University%20Course/jyy%20OS2024/Mini%20Labs/M3/M3.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    M3
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_3" >
        
          
          <label class="md-nav__link" for="__nav_3_1_1_3" id="__nav_3_1_1_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    OS Labs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_3">
            <span class="md-nav__icon md-icon"></span>
            OS Labs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Course/University%20Course/jyy%20OS2024/OS%20Labs/L0/L0.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    L0
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Course/University%20Course/jyy%20OS2024/OS%20Labs/L1/L1.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    L1
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    GeekTime
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            GeekTime
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_1" >
        
          
          <label class="md-nav__link" for="__nav_3_2_1" id="__nav_3_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    深入理解计算机组成原理
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_1">
            <span class="md-nav__icon md-icon"></span>
            深入理解计算机组成原理
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Course/GeekTime/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/%E4%B8%80%E5%91%A8%E7%9B%AE/1.%20%E6%8C%87%E4%BB%A4%E4%B8%8E%E8%BF%90%E7%AE%97/%E6%8C%87%E4%BB%A4%E4%B8%8E%E8%BF%90%E7%AE%97.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. 指令与运算
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Course/GeekTime/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/%E4%B8%80%E5%91%A8%E7%9B%AE/2.%20%E5%A4%84%E7%90%86%E5%99%A8/%E5%A4%84%E7%90%86%E5%99%A8.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. 处理器
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Course/GeekTime/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/%E4%B8%80%E5%91%A8%E7%9B%AE/3.%20%E5%AD%98%E5%82%A8%E4%B8%8EIO%E7%B3%BB%E7%BB%9F/%E5%AD%98%E5%82%A8%E4%B8%8EIO%E7%B3%BB%E7%BB%9F.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. 存储与IO系统
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Course/GeekTime/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/%E4%B8%80%E5%91%A8%E7%9B%AE/4.%20%E5%BA%94%E7%94%A8/%E5%BA%94%E7%94%A8.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. 应用
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2_2" id="__nav_3_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    计算基础实战课
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_2">
            <span class="md-nav__icon md-icon"></span>
            计算基础实战课
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Course/GeekTime/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80%E5%AE%9E%E6%88%98%E8%AF%BE/1.%20MiniCPU%E8%AE%BE%E8%AE%A1/MiniCPU%E8%AE%BE%E8%AE%A1.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. MiniCPU设计
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Course/GeekTime/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80%E5%AE%9E%E6%88%98%E8%AF%BE/2.%20%E8%AF%AD%E8%A8%80%E5%92%8C%E6%8C%87%E4%BB%A4/%E8%AF%AD%E8%A8%80%E5%92%8C%E6%8C%87%E4%BB%A4.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. 语言和指令
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Course/GeekTime/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80%E5%AE%9E%E6%88%98%E8%AF%BE/3.%20%E5%BA%94%E7%94%A8%E5%92%8C%E5%86%85%E5%AD%98/%E5%BA%94%E7%94%A8%E5%92%8C%E5%86%85%E5%AD%98.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. 应用和内存
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Course/GeekTime/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80%E5%AE%9E%E6%88%98%E8%AF%BE/4.%20IO%E4%B8%8E%E6%96%87%E4%BB%B6/IO%E5%92%8C%E6%96%87%E4%BB%B6.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. IO与文件
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Course/GeekTime/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80%E5%AE%9E%E6%88%98%E8%AF%BE/5.%20%E7%BB%BC%E5%90%88%E5%BA%94%E7%94%A8/synthesis.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5. 综合应用
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Course/GeekTime/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80%E5%AE%9E%E6%88%98%E8%AF%BE/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE%E5%92%8C%E5%B7%A5%E5%85%B7%E9%93%BE/%E7%9B%B8%E5%85%B3%E9%85%8D%E7%BD%AE.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    环境配置和工具链
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ysyx
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            ysyx
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    NJU-ICS2023-PA
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            NJU-ICS2023-PA
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ysyx/pa/pa1/pa1.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PA1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ysyx/pa/pa2/pa2.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PA2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ysyx/pa/pa3/pa3.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PA3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ysyx/pa/pa4/pa4.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PA4
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ysyx/pa/c_marco/macro.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    C Macro
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ysyx/pa/summary/summary.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Summary
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ysyx/pa/Linux_porting/porting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linux Porting
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ysyx/digital-circuit/digital%20circuit.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Digital Circuit
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tools
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Tools/GDB/GDB.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GDB
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Vim
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Vim
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Tools/vim/usage/usage.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    usage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Tools/vim/vim-plugin/vim.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vim-plugin
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Tools/doxygen/doxygen.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    doxygen
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Tools/gcc/gcc.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    gcc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Tools/Git/Git.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Git
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Tools/md2slider/md2slider.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    md2slider
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Tools/tmux/tmux.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tmux
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Todo%20List/todo.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TODO List
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#brief-description" class="md-nav__link">
    <span class="md-ellipsis">
      Brief description
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Brief description">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#features-and-usage-of-apr" class="md-nav__link">
    <span class="md-ellipsis">
      Features and Usage of APR:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#some-header-files-in-devpkg" class="md-nav__link">
    <span class="md-ellipsis">
      Some header files in devpkg
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Some header files in devpkg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#apr" class="md-nav__link">
    <span class="md-ellipsis">
      APR
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bstrlib" class="md-nav__link">
    <span class="md-ellipsis">
      bstrlib
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#variant-function" class="md-nav__link">
    <span class="md-ellipsis">
      variant function
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#functions-in-apr-library" class="md-nav__link">
    <span class="md-ellipsis">
      Functions in APR library
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions in APR library">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dbc" class="md-nav__link">
    <span class="md-ellipsis">
      db.c
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shellc" class="md-nav__link">
    <span class="md-ellipsis">
      shell.c
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#commandsc" class="md-nav__link">
    <span class="md-ellipsis">
      commands.c
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-use-of-bstrlib" class="md-nav__link">
    <span class="md-ellipsis">
      The use of bstrlib
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-use-of-variant-function" class="md-nav__link">
    <span class="md-ellipsis">
      The use of variant function
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The use of variant function">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#introduce" class="md-nav__link">
    <span class="md-ellipsis">
      Introduce
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-order-of-using" class="md-nav__link">
    <span class="md-ellipsis">
      The order of using
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analysis-of-shellc" class="md-nav__link">
    <span class="md-ellipsis">
      Analysis of shell.c
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analysis-of-commandsc" class="md-nav__link">
    <span class="md-ellipsis">
      Analysis of commands.c
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Analysis of commands.c">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#functionsexample-installing-a-package" class="md-nav__link">
    <span class="md-ellipsis">
      Functions（example: Installing a Package）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Brief description</h1>

<h2 id="brief-description">Brief description</h2>
<p>​   Apache Portable Runtime (APR) project is a sub-project of the Apache Software Foundation, providing a cross-platform library to support the development of Apache HTTP Server and other related projects.
​   The goal of APR is to offer a universal, portable programming interface that allows developers to easily <strong>write cross-platform applications.</strong></p>
<h4 id="features-and-usage-of-apr">Features and Usage of APR:</h4>
<ol>
<li>Cross-platform:
APR offers a cross-platform API,
enabling developers to write code with the same functionality on
different operating systems without worrying about
platform-specific details.</li>
<li>Low-level functionality support:
APR encapsulates many low-level functionalities such as memory management,
file operations, network operations, making it easier for
developers to access these functionalities.</li>
<li>Thread support:
APR provides a thread library, allowing developers to use multithreading
in their applications for concurrent processing.</li>
<li>Memory pool:
APR provides a memory pool mechanism for more efficient memory allocation
and deallocation, avoiding memory leaks and fragmentation.</li>
<li>Network programming:
APR offers network programming-related functionalities like socket operations,
network address handling, facilitating the development
of network applications.</li>
<li>File operations:
APR provides file operation functionalities such as file read/write,
file attribute operations, making it convenient for developing file
handling applications.</li>
</ol>
<h2 id="some-header-files-in-devpkg">Some header files in devpkg</h2>
<h4 id="apr">APR</h4>
<ul>
<li><code>#include "apr_errno.h"</code></li>
<li><code>#include "apr_pools.h"</code></li>
<li><code>#include "apr_thread_proc.h"</code></li>
<li><code>#include &lt;apr_errno.h&gt;</code></li>
<li><code>#include &lt;apr_file_io.h&gt;</code></li>
</ul>
<h4 id="bstrlib">bstrlib</h4>
<ul>
<li><code>#include "bstrlib.h"</code></li>
</ul>
<h4 id="variant-function">variant function</h4>
<ul>
<li><code>#include &lt;stdarg.h&gt;</code></li>
</ul>
<h2 id="functions-in-apr-library">Functions in APR library</h2>
<blockquote>
<p>Some functions and marcos from the Apache Portable Runtime (APR) library are used in the devpkg.
Make simple introduction</p>
</blockquote>
<h4 id="dbc">db.c</h4>
<ol>
<li>
<p><code>apr_pool_t *p = NULL;</code></p>
</li>
<li>
<p><strong>Purpose</strong>: Declare a pointer to the APR memory pool.</p>
</li>
<li>
<p><strong>Features</strong>: A memory pool is a mechanism in APR for allocating and managing memory, which can improve the efficiency and management of memory allocation.</p>
</li>
<li>
<p><code>apr_pool_initialize();</code></p>
</li>
<li><strong>Purpose</strong>: Initialize the memory pool system in the APR library.</li>
<li>
<p><strong>Function</strong>: This function needs to be called for initialization before using the APR memory pool.</p>
</li>
<li>
<p><code>apr_pool_create(&amp;p, NULL);</code></p>
</li>
<li>
<p><strong>Purpose</strong>: Create a new APR memory pool.</p>
</li>
<li>
<p><strong>Feature</strong>: Used to create a new memory pool that can be used to allocate memory and manage resources.</p>
</li>
<li>
<p><code>apr_status_t rc = apr_dir_make_recursive(DB_DIR, APR_UREAD | APR_UWRITE | APR_UEXECUTE | APR_GREAD | APR_GWRITE | APR_GEXECUTE, p);</code></p>
</li>
<li><strong>Purpose</strong>: Create a directory recursively.</li>
<li>
<p><strong>Function</strong>: Create directories with specified permissions, including read, write, and execute permissions for users and groups.</p>
</li>
<li>
<p><code>apr_status_t</code></p>
</li>
<li>
<p><strong>Function</strong>: The return type of the function in the APR library, which indicates the status of the function execution result.</p>
</li>
</ol>
<h4 id="shellc">shell.c</h4>
<ol>
<li>
<p><code>apr_procattr_create();</code></p>
<div class="highlight"><pre><span></span><code><span class="cm">/**</span>
<span class="cm"> * Create and initialize a new procattr variable</span>
<span class="cm"> * @param new_attr The newly created procattr. </span>
<span class="cm"> * @param cont The pool to use</span>
<span class="cm"> */</span>
<span class="n">APR_DECLARE</span><span class="p">(</span><span class="n">apr_status_t</span><span class="p">)</span><span class="w"> </span><span class="n">apr_procattr_create</span><span class="p">(</span><span class="n">apr_procattr_t</span><span class="w"> </span><span class="o">**</span><span class="n">new_attr</span><span class="p">,</span>
<span class="w">                                                  </span><span class="n">apr_pool_t</span><span class="w"> </span><span class="o">*</span><span class="n">cont</span><span class="p">);</span>
</code></pre></div>
<ul>
<li>
<p><strong>Purpose</strong>: Prepare the environment for launching a new child process. </p>
<p>The function initializes a structure to specify the attributes of the child process, such as the starting directory, input/output streams, etc.</p>
</li>
</ul>
</li>
<li>
<p><code>apr_procattr_io_set();</code></p>
<div class="highlight"><pre><span></span><code><span class="cm">/**</span>
<span class="cm"> * Determine if any of stdin, stdout, or stderr should be linked to pipes </span>
<span class="cm"> * when starting a child process.</span>
<span class="cm"> * @param attr The procattr we care about. </span>
<span class="cm"> * @param in Should stdin be a pipe back to the parent?</span>
<span class="cm"> * @param out Should stdout be a pipe back to the parent?</span>
<span class="cm"> * @param err Should stderr be a pipe back to the parent?</span>
<span class="cm"> * @note If APR_NO_PIPE, there will be no special channel, the child</span>
<span class="cm"> * inherits the parent&#39;s corresponding stdio stream.  If APR_NO_FILE is </span>
<span class="cm"> * specified, that corresponding stream is closed in the child (and will</span>
<span class="cm"> * be INVALID_HANDLE_VALUE when inspected on Win32). This can have ugly </span>
<span class="cm"> * side effects, as the next file opened in the child on Unix will fall</span>
<span class="cm"> * into the stdio stream fd slot!</span>
<span class="cm"> */</span>
<span class="n">APR_DECLARE</span><span class="p">(</span><span class="n">apr_status_t</span><span class="p">)</span><span class="w"> </span><span class="n">apr_procattr_io_set</span><span class="p">(</span><span class="n">apr_procattr_t</span><span class="w"> </span><span class="o">*</span><span class="n">attr</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                             </span><span class="n">apr_int32_t</span><span class="w"> </span><span class="n">in</span><span class="p">,</span><span class="w"> </span><span class="n">apr_int32_t</span><span class="w"> </span><span class="n">out</span><span class="p">,</span>
<span class="w">                                             </span><span class="n">apr_int32_t</span><span class="w"> </span><span class="n">err</span><span class="p">);</span>
</code></pre></div>
<ul>
<li><strong>Purpose</strong>: This function is used to set the handling of the standard input, output, and error streams of the child process. By controlling these pipe connections, inter-process communication and redirection can be achieved.</li>
</ul>
</li>
<li>
<p><code>apr_procattr_dir_set:</code></p>
<div class="highlight"><pre><span></span><code><span class="cm">/**</span>
<span class="cm"> * Set which directory the child process should start executing in.</span>
<span class="cm"> * @param attr The procattr we care about. </span>
<span class="cm"> * @param dir Which dir to start in.  By default, this is the same dir as</span>
<span class="cm"> *            the parent currently resides in, when the createprocess call</span>
<span class="cm"> *            is made.                            </span>
<span class="cm"> */</span>
<span class="n">APR_DECLARE</span><span class="p">(</span><span class="n">apr_status_t</span><span class="p">)</span><span class="w"> </span><span class="n">apr_procattr_dir_set</span><span class="p">(</span><span class="n">apr_procattr_t</span><span class="w"> </span><span class="o">*</span><span class="n">attr</span><span class="p">,</span>
<span class="w">                                                </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">dir</span><span class="p">);</span>
</code></pre></div>
<ul>
<li><strong>Purpose</strong>: This function specifies the starting directory of the child process. When the child process is launched, it will switch to the specified directory to execute subsequent operations.</li>
</ul>
</li>
<li>
<p><code>apr_procattr_cmdtype_set:</code></p>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="cm">/**</span>
<span class="cm"> * Set what type of command the child process will call.</span>
<span class="cm"> * @param attr The procattr we care about. </span>
<span class="cm"> * @param cmd The type of command.  One of:</span>
<span class="cm"> * &lt;PRE&gt;</span>
<span class="cm"> *            APR_SHELLCMD     --  Anything that the shell can handle</span>
<span class="cm"> *            APR_PROGRAM      --  Executable program   (default) </span>
<span class="cm"> *            APR_PROGRAM_ENV  --  Executable program, copy environment</span>
<span class="cm"> *            APR_PROGRAM_PATH --  Executable program on PATH, copy env</span>
<span class="cm"> * &lt;/PRE&gt;</span>
<span class="cm"> */</span>
<span class="n">APR_DECLARE</span><span class="p">(</span><span class="n">apr_status_t</span><span class="p">)</span><span class="w"> </span><span class="n">apr_procattr_cmdtype_set</span><span class="p">(</span><span class="n">apr_procattr_t</span><span class="w"> </span><span class="o">*</span><span class="n">attr</span><span class="p">,</span>
<span class="w">                                                  </span><span class="n">apr_cmdtype_e</span><span class="w"> </span><span class="n">cmd</span><span class="p">);</span>
</code></pre></div>
<ul>
<li><strong>Purpose</strong>: By setting the command type, you can specify the type of command the child process will execute, such as executable program, shell command, etc.</li>
</ul>
</li>
<li>
<p><code>apr_proc_create:</code></p>
<div class="highlight"><pre><span></span><code><span class="cm">/**</span>
<span class="cm"> * Create a new process and execute a new program within that process.</span>
<span class="cm"> * @param new_proc The resulting process handle.</span>
<span class="cm"> * @param progname The program to run </span>
<span class="cm"> * @param args the arguments to pass to the new program.  The first </span>
<span class="cm"> *             one should be the program name.</span>
<span class="cm"> * @param env The new environment table for the new process.  This </span>
<span class="cm"> *            should be a list of NULL-terminated strings. This argument</span>
<span class="cm"> *            is ignored for APR_PROGRAM_ENV, APR_PROGRAM_PATH, and                                                                                               </span>
<span class="cm"> *            APR_SHELLCMD_ENV types of commands.</span>
<span class="cm"> * @param attr the procattr we should use to determine how to create the new</span>
<span class="cm"> *         process</span>
<span class="cm"> * @param pool The pool to use.</span>
<span class="cm"> * @note This function returns without waiting for the new process to terminate;</span>
<span class="cm"> * use apr_proc_wait for that.</span>
<span class="cm"> */</span>
<span class="n">APR_DECLARE</span><span class="p">(</span><span class="n">apr_status_t</span><span class="p">)</span><span class="w"> </span><span class="n">apr_proc_create</span><span class="p">(</span><span class="n">apr_proc_t</span><span class="w"> </span><span class="o">*</span><span class="n">new_proc</span><span class="p">,</span>
<span class="w">                                          </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">progname</span><span class="p">,</span>
<span class="w">                                          </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="o">*</span><span class="n">args</span><span class="p">,</span>
<span class="w">                                          </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="o">*</span><span class="n">env</span><span class="p">,</span>
<span class="w">                                          </span><span class="n">apr_procattr_t</span><span class="w"> </span><span class="o">*</span><span class="n">attr</span><span class="p">,</span>
<span class="w">                                          </span><span class="n">apr_pool_t</span><span class="w"> </span><span class="o">*</span><span class="n">pool</span><span class="p">);</span>
</code></pre></div>
<ul>
<li><strong>Purpose</strong>: This function actually creates a new process based on the current process and executes the specified program within it. It uses the previously set <code>apr_procattr_t</code> structure to determine the attributes of the new process.</li>
</ul>
</li>
</ol>
<blockquote>
<p><strong><mark>Some thoughts while coding</mark></strong></p>
<p>The answer from GPT：</p>
<p>The function <code>Shell_run</code> initializes many attributes of the new process before creating the process for several reasons:</p>
<ol>
<li><strong>Granular Control</strong>: By setting attributes before creating the process, the function can have granular control over various aspects of the new process, such as I/O settings, root directory, command type, etc. This allows for customization and fine-tuning of the process's behavior and environment.</li>
<li><strong>Error Handling</strong>: Setting attributes individually allows for better error handling. If any attribute setting fails, the function can catch the error and handle it appropriately. This approach helps in ensuring that the process creation is successful and provides detailed error messages in case of failures.</li>
<li><strong>Modularity and Readability</strong>: Initializing attributes separately makes the code modular and easier to read and maintain. Each step in the process is clearly defined and can be easily understood, making the code more organized and structured.</li>
</ol>
<p>Regarding passing all related information when using <code>apr_proc_create</code> directly, it is a matter of design choice and flexibility. By setting attributes individually, the function can have more control over each aspect of the process creation. This approach also allows for better error checking and handling at each step.</p>
</blockquote>
<ol>
<li>
<p><code>apr_proc_wait:</code></p>
<div class="highlight"><pre><span></span><code><span class="cm">/**</span>
<span class="cm"> * Wait for a child process to die</span>
<span class="cm"> * @param proc The process handle that corresponds to the desired child process </span>
<span class="cm"> * @param exitcode The returned exit status of the child, if a child process </span>
<span class="cm"> *                 dies, or the signal that caused the child to die.</span>
<span class="cm"> *                 On platforms that don&#39;t support obtaining this information, </span>
<span class="cm"> *                 the status parameter will be returned as APR_ENOTIMPL.</span>
<span class="cm"> * @param exitwhy Why the child died, the bitwise or of:</span>
<span class="cm"> * &lt;PRE&gt;</span>
<span class="cm"> *            APR_PROC_EXIT         -- process terminated normally</span>
<span class="cm"> *            APR_PROC_SIGNAL       -- process was killed by a signal</span>
<span class="cm"> *            APR_PROC_SIGNAL_CORE  -- process was killed by a signal, and</span>
<span class="cm"> *                                     generated a core dump.</span>
<span class="cm"> * &lt;/PRE&gt;</span>
<span class="cm"> * @param waithow How should we wait.  One of:</span>
<span class="cm"> * &lt;PRE&gt;</span>
<span class="cm"> *            APR_WAIT   -- block until the child process dies.</span>
<span class="cm"> *            APR_NOWAIT -- return immediately regardless of if the </span>
<span class="cm"> *                          child is dead or not.</span>
<span class="cm"> * &lt;/PRE&gt;</span>
<span class="cm"> * @remark The child&#39;s status is in the return code to this process.  It is one of:</span>
<span class="cm"> * &lt;PRE&gt;</span>
<span class="cm"> *            APR_CHILD_DONE     -- child is no longer running.</span>
<span class="cm"> *            APR_CHILD_NOTDONE  -- child is still running.</span>
<span class="cm"> * &lt;/PRE&gt;</span>
<span class="cm"> */</span>
<span class="n">APR_DECLARE</span><span class="p">(</span><span class="n">apr_status_t</span><span class="p">)</span><span class="w"> </span><span class="n">apr_proc_wait</span><span class="p">(</span><span class="n">apr_proc_t</span><span class="w"> </span><span class="o">*</span><span class="n">proc</span><span class="p">,</span>
<span class="w">                                        </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">exitcode</span><span class="p">,</span><span class="w"> </span><span class="n">apr_exit_why_e</span><span class="w"> </span><span class="o">*</span><span class="n">exitwhy</span><span class="p">,</span>
<span class="w">                                        </span><span class="n">apr_wait_how_e</span><span class="w"> </span><span class="n">waithow</span><span class="p">);</span>
</code></pre></div>
<ul>
<li><strong>Purpose</strong>: This function waits for the specified child process to exit and retrieves its exit status and exit reason. This function can be used to achieve inter-process synchronization and handle the exit status of child processes.</li>
</ul>
</li>
<li>
<p><code>apr_procattr_t *attr</code>:</p>
<ul>
<li>
<p><strong>Type</strong>: Pointer to the <code>apr_procattr_t</code> structure.</p>
</li>
<li>
<p><strong>Purpose</strong>: This variable is used to store attributes for process creation.</p>
<p>In the Apache Portable Runtime (APR) library, the <code>apr_procattr_t</code> structure is used to set and control the attributes of a new process, such as environment variables, file descriptors, signal handling, etc. </p>
<p>By configuring the <code>apr_procattr_t</code> structure, the behavior and execution environment of the new process can be influenced.</p>
</li>
</ul>
</li>
<li>
<p><code>apr_status_t rv</code>:</p>
<ul>
<li>
<p><strong>Type</strong>: <code>apr_status_t</code>, typically used to represent the return value of a function.</p>
</li>
<li>
<p><strong>Purpose</strong>: This variable is used to store the return value of a function call. </p>
<p>In the APR library, most function return types are <code>apr_status_t</code>, which indicates the result of the function execution, such as success, failure, error codes, etc. </p>
<p>Programmers can use the value of <code>rv</code> to determine the success of a function call and perform subsequent handling as needed.</p>
</li>
</ul>
</li>
<li>
<p><code>apr_proc_t newproc</code>:</p>
<ul>
<li>
<p><strong>Type</strong>: <code>apr_proc_t</code> structure.</p>
</li>
<li>
<p><strong>Purpose</strong>: This variable represents the newly created process. </p>
<p>After calling a function to create a process, the <code>newproc</code> variable can be used to access information about the new process, such as the process ID, input/output streams, etc. </p>
<p>The <code>apr_proc_t</code> structure typically contains basic attributes and status information of the process.</p>
</li>
</ul>
</li>
<li>
<p><code>apr_procattr_t *attr</code> is used to set attributes for the new process.</p>
</li>
<li><code>apr_status_t rv</code> is used to store the return value of function calls for error handling.</li>
<li>
<p><code>apr_proc_t newproc</code> represents the newly created process and provides access to its related information.</p>
</li>
<li>
<p><code>Some basic marcos</code></p>
<p>The use of macro definitions such as <code>APR_SUCCESS</code>, <code>APR_CHILD_DONE</code>, <code>APR_WAIT</code>, <code>APR_PROC_EXIT</code> helps in handling different states and events during process-related operations. </p>
</li>
</ol>
<h4 id="commandsc">commands.c</h4>
<h2 id="the-use-of-bstrlib">The use of bstrlib</h2>
<h2 id="the-use-of-variant-function">The use of variant function</h2>
<blockquote>
<p>The most commonly used macros are </p>
<p><code>va_list</code>, <code>va_start</code>, <code>va_arg</code>, and <code>va_end</code>.</p>
</blockquote>
<h4 id="introduce">Introduce</h4>
<ol>
<li>
<p><code>va_list</code>: A type defined in the <code>stdarg.h</code> header that is used to declare a list of arguments.</p>
</li>
<li>
<p><code>va_start</code>: A macro that initializes a <code>va_list</code> object to point to the first variadic argument in the function call. It takes two arguments: the <code>va_list</code> object and the last named parameter before the variadic arguments.</p>
</li>
<li>
<p><code>va_arg</code>: A macro that retrieves the next argument from the variable argument list. It takes two arguments: the <code>va_list</code>object and the type of the next argument to retrieve. It returns the value of the argument and advances the <code>va_list</code>object to the next argument.</p>
</li>
<li>
<p><code>va_end</code>: A macro that cleans up the <code>va_list</code> object after all arguments have been processed. It should always be called after processing all variadic arguments.</p>
</li>
</ol>
<p>​    </p>
<h4 id="the-order-of-using">The order of using</h4>
<ol>
<li>Declare a <code>va_list</code> object.</li>
<li>Initialize the <code>va_list</code> object using <code>va_start</code> with the last named parameter before the variadic arguments.</li>
<li>Use <code>va_arg</code> to retrieve and process each argument in the list, advancing the <code>va_list</code> object each time.</li>
<li>Repeat step 3 until all variadic arguments have been processed.</li>
<li>
<p>Clean up the <code>va_list</code> object using <code>va_end</code>.</p>
</li>
<li>
<p>simple example</p>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdarg.h&gt;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">print_values</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="p">,</span><span class="w"> </span><span class="p">...)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">va_list</span><span class="w"> </span><span class="n">args</span><span class="p">;</span>
<span class="w">    </span><span class="n">va_start</span><span class="p">(</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="n">count</span><span class="p">);</span><span class="w"> </span><span class="c1">// Initialize va_list</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">count</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">va_arg</span><span class="p">(</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="p">);</span><span class="w"> </span><span class="c1">// Retrieve argument</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;%d &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">va_end</span><span class="p">(</span><span class="n">args</span><span class="p">);</span><span class="w"> </span><span class="c1">// Clean up va_list</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">print_values</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</li>
</ol>
<p><strong><mark>Then you can analyse the <code>shell_exec()</code> step by step</mark></strong></p>
<h2 id="analysis-of-shellc">Analysis of shell.c</h2>
<div class="highlight"><pre><span></span><code><span class="cm">/* </span>
<span class="cm"> * @brief Execute a shell command with variable arguments.</span>
<span class="cm"> * @param template: The Shell struct containing the template command to run.</span>
<span class="cm"> * @param ...: Variable arguments to be substituted into the template command.</span>
<span class="cm"> * Returns: 0 if the command was executed successfully, -1 if there was an error.</span>
<span class="cm"> * </span>
<span class="cm"> * @Note </span>
<span class="cm"> * Remember to end the variable argument list with a NULL value.</span>
<span class="cm"> */</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">Shell_exec</span><span class="p">(</span><span class="n">Shell</span><span class="w"> </span><span class="n">template</span><span class="p">,</span><span class="w"> </span><span class="p">...)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">apr_pool_t</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">rc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span>
<span class="w">    </span><span class="n">apr_status_t</span><span class="w"> </span><span class="n">rv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">APR_SUCCESS</span><span class="p">;</span>
<span class="w">    </span><span class="kt">va_list</span><span class="w"> </span><span class="n">argp</span><span class="p">;</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">arg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">    </span><span class="n">rv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">apr_pool_create</span><span class="p">(</span><span class="o">&amp;</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<span class="w">    </span><span class="n">check</span><span class="p">(</span><span class="n">rv</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">APR_SUCCESS</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Failed to create pool.&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="n">va_start</span><span class="p">(</span><span class="n">argp</span><span class="p">,</span><span class="w"> </span><span class="n">template</span><span class="p">);</span>

<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">va_arg</span><span class="p">(</span><span class="n">argp</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">);</span>
<span class="w">        </span><span class="n">key</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<span class="w">        </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">va_arg</span><span class="p">(</span><span class="n">argp</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">))</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">arg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">va_arg</span><span class="p">(</span><span class="n">argp</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">);</span>

<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">template</span><span class="p">.</span><span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="n">template</span><span class="p">.</span><span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">                </span><span class="n">template</span><span class="p">.</span><span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">arg</span><span class="p">;</span>
<span class="w">                </span><span class="k">break</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">rc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Shell_run</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">template</span><span class="p">);</span>
<span class="w">    </span><span class="n">check</span><span class="p">(</span><span class="n">rc</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;the command &#39;%s&#39; was executed unsuccessfully&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">template</span><span class="p">.</span><span class="n">args</span><span class="p">);</span>
<span class="w">    </span><span class="n">apr_pool_destroy</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<span class="w">    </span><span class="n">va_end</span><span class="p">(</span><span class="n">argp</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">rc</span><span class="p">;</span>

<span class="nl">error</span><span class="p">:</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">apr_pool_destroy</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">rc</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">Shell</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">dir</span><span class="p">;</span><span class="w">        </span><span class="c1">// The directory in which the command will be executed</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">exe</span><span class="p">;</span><span class="w">        </span><span class="c1">// The executable command</span>

<span class="w">    </span><span class="n">apr_procattr_t</span><span class="w"> </span><span class="o">*</span><span class="n">attr</span><span class="p">;</span><span class="w">   </span><span class="c1">// The attribute of the process</span>
<span class="w">    </span><span class="n">apr_proc_t</span><span class="w"> </span><span class="n">proc</span><span class="p">;</span><span class="w">        </span><span class="c1">// The process information </span>
<span class="w">    </span><span class="n">apr_exit_why_e</span><span class="w"> </span><span class="n">exit_why</span><span class="p">;</span><span class="c1">// The reason for process exit</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">exit_code</span><span class="p">;</span><span class="w">          </span><span class="c1">// The exit code of the process</span>

<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">args</span><span class="p">[</span><span class="n">MAX_COMMAND_ARGS</span><span class="p">];</span><span class="c1">// The arguments for the commmand</span>
<span class="p">}</span><span class="w"> </span><span class="n">Shell</span><span class="p">;</span>
</code></pre></div>
<p>Let's clarify the concept of key-value pairs in the context of the <code>Shell_exec</code> function and the <code>Shell</code> structure with a real example involving a shell command:</p>
<ol>
<li><strong>Key-Value Pairs</strong>:</li>
<li>
<p>In the <code>Shell_exec</code> function:</p>
<ul>
<li><strong>Key</strong>: The <code>key</code> variable (<code>const char *key</code>) that you define in the function. This key is used to identify which argument in the <code>template.args</code> array needs to be replaced.</li>
<li><strong>Value</strong>: The <code>argp</code> variable (<code>const char *arg = NULL;</code>) that you provide as the new argument associated with the key. This value will replace the existing argument in the <code>template.args</code> array.</li>
</ul>
</li>
<li>
<p>In the <code>Shell</code> structure:</p>
<ul>
<li><strong>Key-Value Pair</strong>: The <code>*args[]</code> array stored in the <code>Shell</code> structure:</li>
<li><strong>Key</strong>: The index of each element in the <code>*args[]</code> array can be considered as the key. For example, <code>args[0]</code> can be seen as the key for the first argument, <code>args[1]</code> for the second argument, and so on.</li>
<li><strong>Value</strong>: The value associated with each key/index in the <code>*args[]</code> array is the actual argument for the shell command.</li>
</ul>
</li>
<li>
<p><strong>Real Example</strong>:</p>
</li>
<li>Let's consider a real shell command like <code>ls</code>, which lists files and directories in the current directory.</li>
<li>
<p>If we have a <code>Shell</code> structure with <code>args</code> array storing the arguments for the command:</p>
<ul>
<li><code>args[0]</code> could be the key for the command itself (<code>ls</code> in this case).</li>
<li>Other elements in the <code>args</code> array (<code>args[1]</code>, <code>args[2]</code>, etc.) could be keys for additional arguments like <code>-l</code> for a detailed list or <code>-a</code> to show hidden files.</li>
</ul>
</li>
<li>
<p><strong>Replacement Process</strong>:</p>
</li>
<li>When a key (index) in the <code>template.args</code> array matches the current key (provided by <code>key</code>), the corresponding value (argument) in the <code>template.args</code> array is replaced with the new argument (<code>argp</code>) associated with that key.</li>
</ol>
<p>In summary, in the context of shell commands and the <code>Shell</code> structure, the keys are represented by the indices of the <code>*args[]</code> array, and the values are the actual arguments for the command. When using key-value pairs in <code>Shell_exec</code>, the key helps identify which argument to replace with a new value.</p>
<p>I hope this explanation helps clarify the concept. If you have any more questions or need further clarification, feel free to ask!</p>
<h2 id="analysis-of-commandsc">Analysis of commands.c</h2>
<h4 id="functionsexample-installing-a-package">Functions（example: Installing a Package）</h4>
<p>Let's walk through an example to illustrate the process of fetching, building, and installing a software package using the functions and commands in the <code>command.c</code> file:</p>
<ol>
<li><strong>Fetch</strong>:</li>
<li>Suppose we want to install a package named "example_package" from a URL.</li>
<li><code>Command_install</code> is called with the URL as a parameter.</li>
<li><code>Command_fetch</code> is invoked to fetch the package:<ul>
<li>It determines the file type (e.g., TAR.GZ) and fetches the package.</li>
<li>If a DEPENDS file is found, it recursively processes dependencies using <code>Command_depends</code>.</li>
</ul>
</li>
<li><strong>Build</strong>:</li>
<li>After fetching, <code>Command_build</code> is called:<ul>
<li>It checks the existence of the build directory.</li>
<li>Runs configure script, make script, and install script to build the package.</li>
<li>Updates the package in the database.</li>
</ul>
</li>
<li><strong>Install</strong>:</li>
<li><code>Command_install</code> continues the installation process:<ul>
<li>Checks if the package is already installed.</li>
<li>If not installed, it fetches the package using <code>Command_fetch</code>.</li>
<li>Calls <code>Command_build</code> to configure, build, and install the package.</li>
</ul>
</li>
<li><strong>Commands</strong>:</li>
<li>Various shell scripts are executed within the functions:<ul>
<li><code>CONFIGURE_SH</code>: Run the configuration script.</li>
<li><code>MAKE_SH</code>: Run the make script.</li>
<li><code>INSTALL_SH</code>: Run the install script.</li>
<li><code>CLEANUP_SH</code>: Perform cleanup tasks after each step.</li>
</ul>
</li>
</ol>
<p><img alt="image-20240301112554353" src="pic/image-20240301112554353.png" /></p>
<h4 id="summary">Summary:</h4>
<ul>
<li><strong>Functions</strong>:</li>
<li><code>Command_fetch</code>: Handles fetching files and processing dependencies.</li>
<li><code>Command_build</code>: Checks build directory, configures, builds, and installs the package.</li>
<li><code>Command_install</code>: Manages the installation process, including fetching and building.</li>
<li>
<p><code>Command_depends</code>: Recursively processes dependencies.</p>
</li>
<li>
<p><strong>Commands</strong>:</p>
</li>
<li><code>Shell_exec</code>: Executes shell commands within the C program.</li>
<li>
<p>Shell scripts (<code>CONFIGURE_SH</code>, <code>MAKE_SH</code>, <code>INSTALL_SH</code>, <code>CLEANUP_SH</code>) perform specific tasks during the installation process.</p>
</li>
<li>
<p><strong>Workflow</strong>:</p>
</li>
<li>Fetching retrieves the package and dependencies.</li>
<li>Building configures and compiles the package.</li>
<li>Installing places the built software on the system.</li>
<li>Commands and functions work together to automate the installation process.</li>
</ul>
<p>By following these steps and utilizing the commands and functions in <code>command.c</code>, the installation of software packages can be streamlined and automated, ensuring a smooth installation process with proper handling of dependencies.</p>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2025-10-08T18:47:26+02:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2025-10-08</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2025-10-08T18:47:26+02:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2025-10-08</span>
  </span>

    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/JAILuo" target="_blank" rel="noopener" title="JAILuo" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.footer"], "search": "../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../../../js/timeago.min.js"></script>
      
        <script src="../../../js/timeago_mkdocs_material.js"></script>
      
        <script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
      
    
  </body>
</html>