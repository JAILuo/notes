
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://jailuo.github.io/notes/Linux/environment/environment.html">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.48">
    
    
      
        <title>Environment - Messy Notes</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/timeago.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../index.html" title="Messy Notes" class="md-header__button md-logo" aria-label="Messy Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Messy Notes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Environment
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256l137.3-137.4c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/JAILuo/notes" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../index.html" title="Messy Notes" class="md-nav__button md-logo" aria-label="Messy Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Messy Notes
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/JAILuo/notes" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    首页
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Article
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Article
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="/article/concurrency sumary/summary.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    concurrency-summary
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="/article/toolchain/toolchain.mc" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    toolchain
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="/article/mount/mount.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mount
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Course
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Course
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    University Course
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            University Course
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1_1" id="__nav_3_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    jyy OS2024
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1">
            <span class="md-nav__icon md-icon"></span>
            jyy OS2024
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1_1_1" id="__nav_3_1_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    course note
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_1">
            <span class="md-nav__icon md-icon"></span>
            course note
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Course/University%20Course/jyy%20OS2024/cousre%20note/1.%20introduction/introduction.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Course/University%20Course/jyy%20OS2024/cousre%20note/2.%20concurrency/concurrency.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    concurrency
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Course/University%20Course/jyy%20OS2024/cousre%20note/3.%20virtualization/virtualization.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    virtualization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Course/University%20Course/jyy%20OS2024/cousre%20note/4.%20kernel/kernel.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kernel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Course/University%20Course/jyy%20OS2024/cousre%20note/5.%20persistence/persistence.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    persistence
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_2" >
        
          
          <label class="md-nav__link" for="__nav_3_1_1_2" id="__nav_3_1_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Mini Labs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_2">
            <span class="md-nav__icon md-icon"></span>
            Mini Labs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Course/University%20Course/jyy%20OS2024/Mini%20Labs/M1/M1.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    M1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Course/University%20Course/jyy%20OS2024/Mini%20Labs/M2/M2.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    M2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Course/University%20Course/jyy%20OS2024/Mini%20Labs/M3/M3.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    M3
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_3" >
        
          
          <label class="md-nav__link" for="__nav_3_1_1_3" id="__nav_3_1_1_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    OS Labs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_3">
            <span class="md-nav__icon md-icon"></span>
            OS Labs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Course/University%20Course/jyy%20OS2024/OS%20Labs/L0/L0.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    L0
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Course/University%20Course/jyy%20OS2024/OS%20Labs/L1/L1.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    L1
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    GeekTime
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            GeekTime
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_1" >
        
          
          <label class="md-nav__link" for="__nav_3_2_1" id="__nav_3_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    深入理解计算机组成原理
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_1">
            <span class="md-nav__icon md-icon"></span>
            深入理解计算机组成原理
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Course/GeekTime/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/%E4%B8%80%E5%91%A8%E7%9B%AE/1.%20%E6%8C%87%E4%BB%A4%E4%B8%8E%E8%BF%90%E7%AE%97/%E6%8C%87%E4%BB%A4%E4%B8%8E%E8%BF%90%E7%AE%97.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. 指令与运算
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Course/GeekTime/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/%E4%B8%80%E5%91%A8%E7%9B%AE/2.%20%E5%A4%84%E7%90%86%E5%99%A8/%E5%A4%84%E7%90%86%E5%99%A8.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. 处理器
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Course/GeekTime/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/%E4%B8%80%E5%91%A8%E7%9B%AE/3.%20%E5%AD%98%E5%82%A8%E4%B8%8EIO%E7%B3%BB%E7%BB%9F/%E5%AD%98%E5%82%A8%E4%B8%8EIO%E7%B3%BB%E7%BB%9F.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. 存储与IO系统
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Course/GeekTime/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/%E4%B8%80%E5%91%A8%E7%9B%AE/4.%20%E5%BA%94%E7%94%A8/%E5%BA%94%E7%94%A8.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. 应用
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2_2" id="__nav_3_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    计算基础实战课
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_2">
            <span class="md-nav__icon md-icon"></span>
            计算基础实战课
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Course/GeekTime/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80%E5%AE%9E%E6%88%98%E8%AF%BE/1.%20MiniCPU%E8%AE%BE%E8%AE%A1/MiniCPU%E8%AE%BE%E8%AE%A1.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. MiniCPU设计
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Course/GeekTime/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80%E5%AE%9E%E6%88%98%E8%AF%BE/2.%20%E8%AF%AD%E8%A8%80%E5%92%8C%E6%8C%87%E4%BB%A4/%E8%AF%AD%E8%A8%80%E5%92%8C%E6%8C%87%E4%BB%A4.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. 语言和指令
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Course/GeekTime/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80%E5%AE%9E%E6%88%98%E8%AF%BE/3.%20%E5%BA%94%E7%94%A8%E5%92%8C%E5%86%85%E5%AD%98/%E5%BA%94%E7%94%A8%E5%92%8C%E5%86%85%E5%AD%98.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. 应用和内存
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Course/GeekTime/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80%E5%AE%9E%E6%88%98%E8%AF%BE/4.%20IO%E4%B8%8E%E6%96%87%E4%BB%B6/IO%E5%92%8C%E6%96%87%E4%BB%B6.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. IO与文件
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Course/GeekTime/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80%E5%AE%9E%E6%88%98%E8%AF%BE/5.%20%E7%BB%BC%E5%90%88%E5%BA%94%E7%94%A8/synthesis.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5. 综合应用
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Course/GeekTime/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80%E5%AE%9E%E6%88%98%E8%AF%BE/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE%E5%92%8C%E5%B7%A5%E5%85%B7%E9%93%BE/%E7%9B%B8%E5%85%B3%E9%85%8D%E7%BD%AE.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    环境配置和工具链
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ysyx
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            ysyx
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    NJU-ICS2023-PA
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            NJU-ICS2023-PA
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ysyx/pa/pa1/pa1.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PA1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ysyx/pa/pa2/pa2.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PA2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ysyx/pa/pa3/pa3.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PA3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ysyx/pa/pa4/pa4.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PA4
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ysyx/pa/c_marco/macro.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    C Macro
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ysyx/pa/summary/summary.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Summary
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ysyx/pa/Linux_porting/porting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linux Porting
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ysyx/digital-circuit/digital%20circuit.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Digital Circuit
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tools
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/GDB/GDB.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GDB
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Vim
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Vim
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/vim/usage/usage.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    usage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/vim/vim-plugin/vim.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vim-plugin
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/doxygen/doxygen.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    doxygen
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/gcc/gcc.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    gcc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/Git/Git.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Git
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/md2slider/md2slider.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    md2slider
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Tools/tmux/tmux.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tmux
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Todo%20List/todo.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TODO List
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      环境搭建
    </span>
  </a>
  
    <nav class="md-nav" aria-label="环境搭建">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      搭建
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      镜像烧写
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      测试
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      控制小车
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      不用显示器
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      从零搭建镜像
    </span>
  </a>
  
    <nav class="md-nav" aria-label="从零搭建镜像">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bsp" class="md-nav__link">
    <span class="md-ellipsis">
      下载 BSP 镜像
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      烧镜像同上
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      板子初始设置
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      远程登陆
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      安装应用
    </span>
  </a>
  
    <nav class="md-nav" aria-label="安装应用">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pytorchai" class="md-nav__link">
    <span class="md-ellipsis">
      pytorch：AI 软件平台
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jetbot" class="md-nav__link">
    <span class="md-ellipsis">
      jetbot：智能车开源项目
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1-nodejs" class="md-nav__link">
    <span class="md-ellipsis">
      步骤 1：重建 Node.js 安装目录
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-nodejs-v16202" class="md-nav__link">
    <span class="md-ellipsis">
      步骤 2：重新安装 Node.js v16.20.2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      步骤 3：配置系统级环境变量
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-sudo" class="md-nav__link">
    <span class="md-ellipsis">
      步骤 4：修复 sudo 环境识别
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    <span class="md-ellipsis">
      步骤 5：验证安装
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      关键目录结构
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      故障排查
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      长期维护建议
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tensorflow" class="md-nav__link">
    <span class="md-ellipsis">
      tensorflow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      远程登陆编辑
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      远程代码提示
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      浏览器远程控制
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      镜像备份和还原
    </span>
  </a>
  
    <nav class="md-nav" aria-label="镜像备份和还原">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      镜像备份
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    <span class="md-ellipsis">
      镜像还原
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    <span class="md-ellipsis">
      源码分析
    </span>
  </a>
  
    <nav class="md-nav" aria-label="源码分析">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cmake" class="md-nav__link">
    <span class="md-ellipsis">
      CMake
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CMake">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hello-world" class="md-nav__link">
    <span class="md-ellipsis">
      hello world
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    <span class="md-ellipsis">
      多文件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    <span class="md-ellipsis">
      多目录
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    <span class="md-ellipsis">
      库生成
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    <span class="md-ellipsis">
      库使用
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_26" class="md-nav__link">
    <span class="md-ellipsis">
      标准结构
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_27" class="md-nav__link">
    <span class="md-ellipsis">
      一、问题根本原因分析
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_28" class="md-nav__link">
    <span class="md-ellipsis">
      二、立即解决方案
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmake_1" class="md-nav__link">
    <span class="md-ellipsis">
      三、CMake高级专业实践指南
    </span>
  </a>
  
    <nav class="md-nav" aria-label="三、CMake高级专业实践指南">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      1. 构建目录管理（核心原则）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-cmake" class="md-nav__link">
    <span class="md-ellipsis">
      2. 现代CMake项目结构（以你的目录为例）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-cmakecmakeliststxt" class="md-nav__link">
    <span class="md-ellipsis">
      3. 现代CMake写法示例（CMakeLists.txt）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-target" class="md-nav__link">
    <span class="md-ellipsis">
      4. 目标（Target）为中心的现代模式
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_1" class="md-nav__link">
    <span class="md-ellipsis">
      5. 高级特性运用
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6" class="md-nav__link">
    <span class="md-ellipsis">
      6. 跨平台最佳实践
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_29" class="md-nav__link">
    <span class="md-ellipsis">
      四、专业开发者工作流
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_30" class="md-nav__link">
    <span class="md-ellipsis">
      五、学习路径推荐
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_31" class="md-nav__link">
    <span class="md-ellipsis">
      系统包安装路径
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#systemctl-linuxservice" class="md-nav__link">
    <span class="md-ellipsis">
      systemctl: 管理Linux的服务的命令(替代service命令）
    </span>
  </a>
  
    <nav class="md-nav" aria-label="systemctl: 管理Linux的服务的命令(替代service命令）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_32" class="md-nav__link">
    <span class="md-ellipsis">
      例子
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_33" class="md-nav__link">
    <span class="md-ellipsis">
      默认启动
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_34" class="md-nav__link">
    <span class="md-ellipsis">
      常用命令
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jetbot_1" class="md-nav__link">
    <span class="md-ellipsis">
      jetbot 源码分析
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Environment</h1>

<h2 id="_1">环境搭建</h2>
<h3 id="_2">搭建</h3>
<p>官方入门   https://developer.nvidia.com/embedded/learn/getting-started-jetson#documentation</p>
<p>智能车项目 https://github.com/NVIDIA-AI-IOT/jetbot</p>
<p>商家资料(微雪智能车)  https://www.waveshare.net/wiki/JetBot_AI_Kit </p>
<p>https://www.waveshare.net/wiki/Jetson_Nano_Developer_Kit</p>
<p>资料： 见云盘 2.官方jetbot环境搭建</p>
<div class="highlight"><pre><span></span><code>https://developer.nvidia.com/ Chrome翻译-&gt; 解决方案 -&gt; 嵌入式和边缘AI -&gt; Jetson开发工具包 -&gt; 入门

Hello AI World教程  //官方提供的学习示例
Jetson项目  //可查看用jetson做的 各种酷炫项目

NVIDIA Jetson 论坛 //可看到 问题的交流信息和最新动向
NVIDIA 开发人员计划 //邮箱加入后，可看最前沿的动态
Jetson AI Fundamentals Series //课程和认证(需翻墙)

Jetson Nano 开发套件 -&gt; 入门指南 //开发板 如何开始开发   

JetBot 自主机器人套件 -&gt; 开始 //是NVIDIA(英伟达)基于JetsoN Nano开发套件而设计的一款开源智能车项目    
Jetson Linux 开发人员指南 //嵌入式底层开发
</code></pre></div>
<h3 id="_3">镜像烧写</h3>
<p>https://github.com/NVIDIA-AI-IOT/jetbot/wiki/Software-Setup</p>
<div class="highlight"><pre><span></span><code>但需翻墙用迅雷下载如jetbot_image_v0p4p0.zip(7G左右 基于jetpack 4.3的微雪用的是这个版本)
</code></pre></div>
<p>https://jetbot.org/master/software_setup/sd_card.html </p>
<div class="highlight"><pre><span></span><code>注：jetbot发布的最新的是分2G版和4G版  jetbot-043_nano-4gb-jp45.zip(13G左右 基于jetpack 4.5的)
 如果要用最新的4.6的，需从零自己做
</code></pre></div>
<blockquote>
<p>烧写工具</p>
<p>https://developer.nvidia.com/embedded/learn/get-started-jetson-nano-devkit#write           下载 SD Card Formatter 5.0.1 Setup.exe 和 balenaEtcher-Setup-1.5.122.exe  </p>
<p>用usb读卡器把sd卡插入电脑 // 注意要用高速sd卡(如闪迪tf卡Extreme)，否则烧写很慢 打开SD Card Formatter  -&gt; Select card 选SD卡  //注意：千万别选错了，把别的盘格式了 -&gt; 选Quick format -&gt; 让Volume label空白 -&gt; 点Format</p>
</blockquote>
<h3 id="_4">测试</h3>
<div class="highlight"><pre><span></span><code>a.插入鼠标 键盘，和hdm线接显示器
b.插入usb线供电，pwer绿灯亮 //要用5v 2A usb电源供电(用笔记本USB接口供电，电流可能不够，最好接插线板)
                          //插入圆孔电源线方式供电(直流 5V 4A) 
                          //注意圆孔旁的跳线帽要连接两边(默认只接一边)
                          //不亮可能是电源线没插好，插帽没接触好
                          //电源绿灯闪烁，表示电源不稳,需把usb供电切换为 5V 4A 圆孔电源供电
C. 启动后登录输入 
  login:  //输入jetbot 
  Password //输入jetbot  
  $ startx  //启动图形界面
  成功则可看到显示器的ubuntu的界面 //第一次需要一些设置 
d.测试wifi联网  
  点右上角 无线wifi图标 -&gt; 选择热点连接 -&gt; 输入密钥 -&gt; 显示连接成功 -&gt; 打开浏览器 能上网表示成功
e.测试摄像头
  $ ls /dev/video0    //默认video0是排线摄像头  video1是usb摄像头
  $ nvgstcapture-1.0 --cus-prev-res=1280x720  //看到显示视频,表示启动csi 排线摄像头成功
</code></pre></div>
<h3 id="_5">控制小车</h3>
<div class="highlight"><pre><span></span><code>去掉键盘鼠标线和hdmi线，
拔掉电源线，插入小车电池的usb线供电线。
上电后oled上会显示ip地址 如192.168.10.237 //会自动链接前面设置好的wifi
电脑上网页访问 http://192.168.10.237:8888  并输入密码jetbot
打开Jupyter Notebook  //网页式交互式笔记本，支持实时代码编程
进入Notebooks/basic_motion/  //点播放按钮，可单步执行(发现能控制小车动了，表示环境成功)
                             //也可点击某步，可选择执行
</code></pre></div>
<h3 id="_6">不用显示器</h3>
<ul>
<li>
<p>串口设置</p>
<div class="highlight"><pre><span></span><code>插上micro usb线 ，接到pc机 重启板子  
重启后，串口终端上会显示一个串口， //通过micro usb线，模拟生成一个串口(不用另外接串口转usb的线）


打开putty， //也可以用别的串口终端

波特率 115200   8 databit  1stopbit  no parity
</code></pre></div>
</li>
<li>
<p>初始设置</p>
<div class="highlight"><pre><span></span><code>只刷机后，第一次运行时，需设置

注意 视频里 说的 sudo ./flash.sh jetson-nano-qspi-sd mmcblk0p1 刷机命令
  跳过不用管， （因这个视频是后面课程录的，挪到前面的，有些不用管）
</code></pre></div>
<p>刷整机后初始设置</p>
</li>
<li>
<p>远程登录</p>
<div class="highlight"><pre><span></span><code>//wifi设置（注意 ChinaNet-xqqe_EXT2.4G 是SSID  lzvjryud是无线密码根据你的情况调整）
$ sudo nmcli device wifi connect &#39;ChinaNet-xqqe_EXT2.4G&#39; password &#39;lzvjryud&#39;

$ ifconfig后可看到ip地址如下
wlan0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500
        inet 192.168.10.237 
</code></pre></div>
<p>改成自己的WiFi密码</p>
</li>
</ul>
<h2 id="_7">从零搭建镜像</h2>
<h3 id="bsp">下载 BSP 镜像</h3>
<div class="highlight"><pre><span></span><code>https://developer.nvidia.com/embedded/downloads 
        //-&gt; 下载SD卡官方原始镜像jetback (用翻墙加迅雷下载快)
JetPack //是bsp板级支持包(即让板子能运行的完整最小系统)
        //包括L4T(bootloader 内核，rootf) 和多媒体库(如cuda opengl等)
        // 和自研AI库(如TensorRT)
        //注：但不包括tensroflow pytorch jetbot等。


//版本匹配问题(2021.10.9查)
https://developer.nvidia.com/zh-cn/embedded/jetpack  //最新发布版本 
https://repo.download.nvidia.com/jetson/  //jetpack详细的支持功能包列表
https://developer.nvidia.com/embedded/linux-tegra-archive //不同版本差异

NVIDIA JetPack SDK //是构建 AI 应用的全面解决方案。支持所有 Jetson 模块和开发者套件
     //最新的是JetPack 4.6, 最新正式版 JetPack 4.4  
    //4.6 板支持 运行中IO配置  https://docs.nvidia.com/jetson/jetpack/release-notes/ -&gt; Jetson -IO 工具
</code></pre></div>
<h3 id="_8">烧镜像同上</h3>
<h3 id="_9">板子初始设置</h3>
<p>板子的第一次ubuntu启动界面，</p>
<p>会要你进行一些初始设置，如语言，选中文简体</p>
<p>你所在地点，wifi设置，和用户名密码。是否需密码登录等。</p>
<p>其它不确定的，用它的默认设置即可</p>
<p>进入ubuntu主页面后，打开浏览器测试一下能否上网，不能则重新设置一下wifi </p>
<div class="highlight"><pre><span></span><code>$ ifconfig   //可查看本机ip地址 如 192.168.10.237
</code></pre></div>
<ul>
<li>
<p>系统信息</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>head<span class="w"> </span>-n<span class="w"> </span><span class="m">1</span><span class="w"> </span>/etc/nv_tegra_release<span class="w">  </span>//查看jetpack版本
<span class="w">                                   </span>//L4t<span class="w"> </span>Verion<span class="w"> </span>is<span class="w"> </span><span class="m">32</span>.6.1<span class="w"> </span>对应<span class="w"> </span>jetpack<span class="w"> </span><span class="m">4</span>.6
<span class="w">  </span><span class="c1"># R32 (release), REVISION: 6.1, GCID: 27863751, BOARD: t210ref, EABI: aarch64, DATE: Mon Jul 26 19:20:30 UTC 2021</span>

$<span class="w"> </span>lsb_release<span class="w"> </span>-a<span class="w"> </span>//查看ubuntu<span class="w"> </span>版本，如输出<span class="w"> </span>Ubuntu<span class="w"> </span><span class="m">18</span>.04.5<span class="w"> </span>LTS<span class="w">  </span>

$<span class="w"> </span>df<span class="w"> </span>-h<span class="w">   </span>//查看磁盘空间
<span class="w">  </span>Filesystem<span class="w">      </span>Size<span class="w">  </span>Used<span class="w"> </span>Avail<span class="w"> </span>Use%<span class="w"> </span>Mounted<span class="w"> </span>on
<span class="w">  </span>/dev/mmcblk0p1<span class="w">  </span>118G<span class="w">   </span>12G<span class="w">  </span>101G<span class="w">  </span><span class="m">11</span>%<span class="w"> </span>/
</code></pre></div>
</li>
<li>
<p>换源</p>
<div class="highlight"><pre><span></span><code>//如更新慢或更新不了，可更改/etc/source.list<span class="w"> </span>添加国内源加速，这里用清华的镜像<span class="w">    </span>
https://mirror.tuna.tsinghua.edu.cn/help/ubuntu/
<span class="w"> </span>-&gt;<span class="w"> </span>选对应ubuntu版本<span class="w"> </span>//如18.04LST
<span class="w"> </span>-&gt;<span class="w"> </span>选架构<span class="w"> </span>//我们是ARM64<span class="w"> </span>,选<span class="w">   </span>ubuntu-ports<span class="w"> </span>镜像<span class="w">    </span>
$<span class="w"> </span>sudo<span class="w"> </span>cp<span class="w"> </span>/etc/apt/sources.list<span class="w"> </span>/etc/apt/sources.list.bak<span class="w">  </span>//备份原来的
//注意：替换源时，是在原sources.list内容里把http://ports.ubuntu.com/
//<span class="w"> </span>替换为<span class="w"> </span>http://mirrors.tuna.tsinghua.edu.cn<span class="w">  </span>
//这里不能用https,否则报错<span class="w">  </span>Certificate<span class="w"> </span>verification<span class="w"> </span>failed:<span class="w"> </span>The<span class="w"> </span>certificate<span class="w"> </span>is<span class="w"> </span>NOT<span class="w"> </span>trusted.
$<span class="w"> </span>sudo<span class="w"> </span>vim<span class="w">  </span>/etc/apt/sources.list<span class="w"> </span>//替换为国内加速源

deb<span class="w"> </span>http://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/<span class="w"> </span>bionic<span class="w"> </span>main<span class="w"> </span>restricted
deb<span class="w"> </span>http://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/<span class="w"> </span>bionic-updates<span class="w"> </span>main<span class="w"> </span>restricted
deb<span class="w"> </span>http://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/<span class="w"> </span>bionic<span class="w"> </span>universe
deb<span class="w"> </span>http://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/<span class="w"> </span>bionic-updates<span class="w"> </span>universe
deb<span class="w"> </span>http://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/<span class="w"> </span>bionic<span class="w"> </span>multiverse
deb<span class="w"> </span>http://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/<span class="w"> </span>bionic-updates<span class="w"> </span>multiverse
deb<span class="w"> </span>http://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/<span class="w"> </span>bionic-backports<span class="w"> </span>main<span class="w"> </span>restricted<span class="w"> </span>universe<span class="w"> </span>multiverse
deb<span class="w"> </span>http://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/<span class="w"> </span>bionic-security<span class="w"> </span>main<span class="w"> </span>restricted
deb<span class="w"> </span>http://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/<span class="w"> </span>bionic-security<span class="w"> </span>universe
deb<span class="w"> </span>http://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/<span class="w"> </span>bionic-security<span class="w"> </span>multiverse
<span class="w"> </span>$<span class="w"> </span>sudo<span class="w"> </span>apt-get<span class="w"> </span>update<span class="w">  </span>//更新源

//注意时间问题：<span class="w"> </span>ubuntu的时间要同步到当前的时间，否则安装升级不了
</code></pre></div>
</li>
<li>
<p>永久设置国内源</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>mkdir<span class="w"> </span>~/.pip
$<span class="w"> </span>vim<span class="w">  </span>~/.pip/pip.conf<span class="w">  </span>//填入下面内容

<span class="o">[</span>global<span class="o">]</span>
<span class="nv">timeout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">300</span>
index-url<span class="w"> </span><span class="o">=</span><span class="w"> </span>https://pypi.tuna.tsinghua.edu.cn/simple
<span class="o">[</span>install<span class="o">]</span>
trusted-host<span class="w"> </span><span class="o">=</span><span class="w"> </span>tsinghua.edu.cn
</code></pre></div>
</li>
</ul>
<h3 id="_10">远程登陆</h3>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ssh<span class="w"> </span>yhbd@192.168.10.237<span class="w">  </span>//远程登录板子<span class="o">(</span>注意用户名，和ip地址，要和板子的一致<span class="o">)</span>
<span class="w">                           </span>//选yes,输入密码后登录
<span class="w">                          </span>//如果之前做过免密登录，登录新板子时，
<span class="w">                          </span>//需把.ssh目录的文件都备份后，删除掉
<span class="w">                          </span>//注意：密钥登录，比较卡最好改为免密登录
$<span class="w"> </span>mkdir<span class="w"> </span>.ssh<span class="w">  </span>//板子上运行创建<span class="w"> </span>.ssh目录，<span class="w"> </span>否则后面免密登录传输公钥文件时会报错<span class="w"> </span>

//免密登录<span class="w">  </span>
新开一终端：<span class="w">    </span>
$<span class="w"> </span>ssh-keygen<span class="w"> </span>-t<span class="w"> </span>rsa<span class="w">  </span>//生成Key私钥和公钥
$<span class="w"> </span>ls<span class="w"> </span>~/.ssh<span class="w"> </span>//发现有生成文件<span class="w"> </span>私钥id_rsa<span class="w"> </span>和<span class="w"> </span>公钥id_rsa.pub<span class="w"> </span>
$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>~/.ssh
$<span class="w"> </span>scp<span class="w"> </span>id_rsa.pub<span class="w"> </span>yhbd@192.168.10.237:/home/yhbd/.ssh/authorized_keys<span class="w"> </span>//上传公钥到板子
<span class="w">               </span>//注意用户名<span class="w"> </span>和ip要改为你的

//以后ssh登录都不用再输密码了。<span class="w">  </span>关键是，不卡了<span class="o">(</span>因密钥登录检测比较多，会比较卡<span class="o">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>vscode<span class="w"> </span>ssh登录不了，可以先在win下，通过ssh登录看看
如<span class="w"> </span>$<span class="w"> </span>ssh<span class="w"> </span><span class="m">192</span>.168.3.10<span class="w">  </span>//如果没有问你输密码就失败了，可以把当前用户目录下.ssh改个名字再试就可以了<span class="w">   </span>

//ssh登录识别，<span class="w"> </span>报错中有<span class="w"> </span>.vscode-server<span class="w"> </span>找不到<span class="w"> </span>
<span class="w"> </span>则到你的当前用户下，下创建<span class="w"> </span>.vscode-server即可<span class="w"> </span>（如我的目录是<span class="w"> </span>创建<span class="w"> </span>C:<span class="se">\U</span>sers<span class="se">\i</span>van）

//ssh登录提示<span class="w"> </span>The<span class="w"> </span>authenticity<span class="w"> </span>of<span class="w"> </span>host<span class="w"> </span>‘192.168.3.10<span class="w"> </span><span class="o">(</span><span class="m">192</span>.168.xxx.xxx<span class="o">)</span>‘<span class="w"> </span>can‘t<span class="w"> </span>be<span class="w"> </span>established.
<span class="w"> </span>修改/etc/ssh/ssh_config文件的配置，以后则不会再出现此问题

最后面添加：
StrictHostKeyChecking<span class="w"> </span>no
UserKnownHostsFile<span class="w"> </span>/dev/null<span class="w"> </span>

然后重启服务
$<span class="w"> </span>sudo<span class="w"> </span>/etc/init.d/ssh<span class="w"> </span>restart<span class="w"> </span>//（或<span class="w"> </span>service<span class="w"> </span>sshd<span class="w"> </span>restart<span class="w"> </span>）
</code></pre></div>
<h3 id="_11">安装应用</h3>
<h4 id="pytorchai"><code>pytorch</code>：AI 软件平台</h4>
<p>源头:</p>
<p>进论坛 https://forums.developer.nvidia.com/  里搜 pytorch </p>
<p>第三方整理网站 https://elinux.org/Jetson_Nano -&gt; PyTorch 安装程序</p>
<div class="highlight"><pre><span></span><code>发现 Jetson 的 PyTorch - 1.9.0 版现已推出
找支持JetPack 4.6 的最新版本下载  
  Python 3.6 - torch-1.9.0-cp36-cp36m-linux_aarch64.whl 
和安装描述          
版本匹配问题： https://github.com/pytorch/vision 
    PyTorch - 1.9.0  需配对 0.10.0 torchvision
</code></pre></div>
<ul>
<li>
<p>传输到板子上</p>
<div class="highlight"><pre><span></span><code>//ubuntu共享方式
<span class="w">  </span>虚拟机<span class="w"> </span>-&gt;<span class="w"> </span>设置<span class="w"> </span>-&gt;<span class="w"> </span>选项<span class="w"> </span>-&gt;<span class="w"> </span>共享文件夹<span class="w"> </span>-&gt;<span class="w"> </span>总是启动<span class="w"> </span>-&gt;<span class="w"> </span>选择共享文件夹
$<span class="w"> </span>vmware-hgfsclient<span class="w"> </span>//启动共享服务
$<span class="w"> </span>mkdir<span class="w"> </span>win_share<span class="w">   </span>//自己创建共享文件夹<span class="o">(</span>不用/mnt/hgfs<span class="o">)</span>，如果已存在文件夹把它删掉，重新建
$<span class="w"> </span>vmhgfs-fuse<span class="w"> </span>.host:/<span class="w">  </span>win_share<span class="w">  </span>//挂载共享目录
$<span class="w"> </span>ls<span class="w"> </span>win_share<span class="w"> </span>//看到共享的内容，表示成功
把下载好文件，放到ubuntu的共享文件夹下
$<span class="w"> </span>scp<span class="w"> </span>torch-1.9.0-cp36-cp36m-linux_aarch64.whl<span class="w"> </span>yhbd@192.168.10.237:/home/yhbd/env<span class="w"> </span>
<span class="w">  </span>//env目录是自己在板子上创建的
//注：也可用wget<span class="w"> </span>直接再板子上下载，但好像有问题
</code></pre></div>
</li>
<li>
<p>安装pytorch(1.9.0)</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>~/env
$<span class="w"> </span>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>python3-pip<span class="w"> </span>libopenblas-base<span class="w"> </span>libopenmpi-dev
$<span class="w"> </span>pip3<span class="w"> </span>install<span class="w"> </span>Cython<span class="w"> </span>--timeout<span class="o">=</span><span class="m">3600</span><span class="w"> </span>//如果还是非常慢<span class="w"> </span>，需更改Ubuntu源，用国内镜像代理网站加速
<span class="w">           </span>//换源后还慢，可设置超时3600秒，避免超时退出
$<span class="w"> </span>pip3<span class="w"> </span>install<span class="w"> </span>numpy<span class="w"> </span>torch-1.9.0-cp36-cp36m-linux_aarch64.whl<span class="w">  </span>--timeout<span class="o">=</span><span class="m">3600</span><span class="w">  </span>
<span class="w">  </span>//安装要20分钟左右
</code></pre></div>
<div class="highlight"><pre><span></span><code> 如不加--timeout=3600  会红色错误：
      urllib3.exceptions.ReadTimeoutError: HTTPSConnectionPool(host=&#39;files.pythonhosted.org&#39;, port=443): Read timed out.
 加了后，成功安装的输出信息是
    Collecting numpy
  Downloading https://files.pythonhosted.org/packages/51/60/3f0fe5b7675a461d96b9d6729beecd3532565743278a9c3fe6dd09697fa7/numpy-1.19.5.zip (7.3MB)
    100% |████████████████████████████████| 7.3MB 12kB/s 
    Processing ./torch-1.9.0-cp36-cp36m-linux_aarch64.whl
    Collecting typing-extensions (from torch==1.9.0)
      Downloading https://files.pythonhosted.org/packages/74/60/18783336cc7fcdd95dae91d73477830aa53f5d3181ae4fe20491d7fc3199/typing_extensions-3.10.0.2-py3-none-any.whl
    Collecting dataclasses; python_version &lt; &quot;3.7&quot; (from torch==1.9.0)
      Downloading https://files.pythonhosted.org/packages/fe/ca/75fac5856ab5cfa51bbbcefa250182e50441074fdc3f803f6e76451fab43/dataclasses-0.8-py3-none-any.whl
    Building wheels for collected packages: numpy
      Running setup.py bdist_wheel for numpy ... |^[[B^[[done
      Stored in directory: /home/yhbd/.cache/pip/wheels/ee/cd/78/686734467766f26e3d2b42605dce9fdb7d24c1c1d26f2fb8fc
    Successfully built numpy
    Installing collected packages: numpy, typing-extensions, dataclasses, torch
    Successfully installed dataclasses-0.8 numpy-1.19.5 torch-1.9.0 typing-extensions-3.10.0.2  
</code></pre></div>
</li>
<li>
<p>安装torchvision(0.10.0)</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>libjpeg-dev<span class="w"> </span>zlib1g-dev<span class="w"> </span>libpython3-dev<span class="w"> </span>libavcodec-dev<span class="w"> </span>libavformat-dev<span class="w"> </span>libswscale-dev
//注：因安装版本较新<span class="w"> </span>不能采用sudo<span class="w"> </span>pip3<span class="w"> </span>install<span class="w"> </span>torchvision<span class="w"> </span>方式安装
//$<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>--branch<span class="w"> </span><span class="m">0</span>.10<span class="w"> </span>https://github.com/pytorch/vision<span class="w"> </span>torchvision<span class="w"> </span>
//<span class="w"> </span>如果直接下载不了<span class="w"> </span>torchvision，可用已下载好的（通过网页板下载<span class="w"> </span><span class="m">0</span>.10版的zip）
//<span class="w"> </span>切换到本地电脑的终端<span class="w"> </span>上传
//$<span class="w"> </span>scp<span class="w"> </span>vision-release-0.10.zip<span class="w"> </span>yhbd@192.168.10.237:/home/yhbd/env
//<span class="w"> </span>再切换到板子终端
$<span class="w"> </span>unzip<span class="w"> </span>vision-release-0.10.zip
$<span class="w"> </span><span class="nb">cd</span><span class="w">    </span>vision-release-0.10
$<span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="nv">BUILD_VERSION</span><span class="o">=</span><span class="m">0</span>.10.0<span class="w">   </span>
$<span class="w"> </span>python3<span class="w"> </span>setup.py<span class="w"> </span>install<span class="w"> </span>--user<span class="w">  </span>//通过源码的脚本<span class="w"> </span>安装torchvision<span class="w">  </span>时间40多分钟
<span class="w">  </span>//中途卡在一个地方比较久，可以Ctrl<span class="w"> </span>+C<span class="w"> </span>终止，重新再运行命令，它会接着前面继续往下编译
<span class="w">  </span>//异常：Download<span class="w">  </span>https://pypi.org/simple/pillow/<span class="w">  </span>下载失败
<span class="w">  </span>//<span class="w"> </span>自己去<span class="w"> </span>https://pypi.org/simple/pillow/<span class="w"> </span>下载Pillow-8.4.0.tar.gz<span class="w"> </span>离线包
<span class="w">  </span>//<span class="w"> </span>$<span class="w"> </span>tar<span class="w"> </span>-xvf<span class="w"> </span>Pillow-8.4.0.tar.gz
<span class="w">  </span>//<span class="w"> </span>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>Pillow-8.4.0<span class="w">   </span>看里面Readme<span class="w">  </span>-&gt;<span class="w"> </span>找到安装说明
<span class="w">  </span>//<span class="w"> </span>$<span class="w"> </span>python3<span class="w"> </span>setup.py<span class="w"> </span>install
<span class="w">  </span>//<span class="w"> </span>安装成功后在重新运行<span class="w"> </span>python3<span class="w"> </span>setup.py<span class="w"> </span>install<span class="w"> </span>--user<span class="w"> </span>就能安装成功了
</code></pre></div>
</li>
<li>
<p>验证</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>python3
Python<span class="w"> </span><span class="m">3</span>.6.9<span class="w"> </span><span class="o">(</span>default,<span class="w"> </span>Jan<span class="w"> </span><span class="m">26</span><span class="w"> </span><span class="m">2021</span>,<span class="w"> </span><span class="m">15</span>:33:00<span class="o">)</span><span class="w"> </span>
<span class="o">[</span>GCC<span class="w"> </span><span class="m">8</span>.4.0<span class="o">]</span><span class="w"> </span>on<span class="w"> </span>linux
Type<span class="w"> </span><span class="s2">&quot;help&quot;</span>,<span class="w"> </span><span class="s2">&quot;copyright&quot;</span>,<span class="w"> </span><span class="s2">&quot;credits&quot;</span><span class="w"> </span>or<span class="w"> </span><span class="s2">&quot;license&quot;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>more<span class="w"> </span>information.
&gt;&gt;&gt;<span class="w"> </span>import<span class="w"> </span>torch
&gt;&gt;&gt;<span class="w"> </span>print<span class="o">(</span>torch.__version__<span class="o">)</span>
<span class="m">1</span>.9.0
&gt;&gt;&gt;<span class="w"> </span>print<span class="o">(</span><span class="s1">&#39;CUDA available: &#39;</span><span class="w"> </span>+<span class="w"> </span>str<span class="o">(</span>torch.cuda.is_available<span class="o">()))</span>
CUDA<span class="w"> </span>available:<span class="w"> </span>True
&gt;&gt;&gt;<span class="w"> </span>print<span class="o">(</span><span class="s1">&#39;cuDNN version: &#39;</span><span class="w"> </span>+<span class="w"> </span>str<span class="o">(</span>torch.backends.cudnn.version<span class="o">()))</span>
cuDNN<span class="w"> </span>version:<span class="w"> </span><span class="m">8201</span>
&gt;&gt;&gt;<span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>torch.cuda.FloatTensor<span class="o">(</span><span class="m">2</span><span class="o">)</span>.zero_<span class="o">()</span>
&gt;&gt;&gt;<span class="w"> </span>print<span class="o">(</span><span class="s1">&#39;Tensor a = &#39;</span><span class="w"> </span>+<span class="w"> </span>str<span class="o">(</span>a<span class="o">))</span>
Tensor<span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>tensor<span class="o">([</span><span class="m">0</span>.,<span class="w"> </span><span class="m">0</span>.<span class="o">]</span>,<span class="w"> </span><span class="nv">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="o">)</span>
&gt;&gt;&gt;<span class="w"> </span><span class="nv">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>torch.randn<span class="o">(</span><span class="m">2</span><span class="o">)</span>.cuda<span class="o">()</span>
&gt;&gt;&gt;<span class="w"> </span>print<span class="o">(</span><span class="s1">&#39;Tensor b = &#39;</span><span class="w"> </span>+<span class="w"> </span>str<span class="o">(</span>b<span class="o">))</span>
Tensor<span class="w"> </span><span class="nv">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>tensor<span class="o">([</span>-0.3519,<span class="w"> </span>-2.3321<span class="o">]</span>,<span class="w"> </span><span class="nv">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="o">)</span>
&gt;&gt;&gt;<span class="w"> </span><span class="nv">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>a<span class="w"> </span>+<span class="w"> </span>b
&gt;&gt;&gt;<span class="w"> </span>print<span class="o">(</span><span class="s1">&#39;Tensor c = &#39;</span><span class="w"> </span>+<span class="w"> </span>str<span class="o">(</span>c<span class="o">))</span>
Tensor<span class="w"> </span><span class="nv">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>tensor<span class="o">([</span>-0.3519,<span class="w"> </span>-2.3321<span class="o">]</span>,<span class="w"> </span><span class="nv">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="o">)</span>
&gt;&gt;&gt;<span class="w"> </span>import<span class="w"> </span>torchvision
/home/yhbd/env/vision-release-0.10/torchvision/__init__.py:26:<span class="w"> </span>UserWarning:<span class="w"> </span>You<span class="w"> </span>are<span class="w"> </span>importing<span class="w"> </span>torchvision<span class="w"> </span>within<span class="w"> </span>its<span class="w"> </span>own<span class="w"> </span>root<span class="w"> </span>folder<span class="w"> </span><span class="o">(</span>/home/yhbd/env/vision-release-0.10<span class="o">)</span>.<span class="w"> </span>This<span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>expected<span class="w"> </span>to<span class="w"> </span>work<span class="w"> </span>and<span class="w"> </span>may<span class="w"> </span>give<span class="w"> </span>errors.<span class="w"> </span>Please<span class="w"> </span><span class="nb">exit</span><span class="w"> </span>the<span class="w"> </span>torchvision<span class="w"> </span>project<span class="w"> </span><span class="nb">source</span><span class="w"> </span>and<span class="w"> </span>relaunch<span class="w"> </span>your<span class="w"> </span>python<span class="w"> </span>interpreter.
<span class="w">  </span>warnings.warn<span class="o">(</span>message.format<span class="o">(</span>os.getcwd<span class="o">()))</span>
&gt;&gt;&gt;<span class="w"> </span>print<span class="o">(</span>torchvision.__version__<span class="o">)</span>
<span class="m">0</span>.10.0
</code></pre></div>
</li>
</ul>
<h4 id="jetbot">jetbot：智能车开源项目</h4>
<div class="highlight"><pre><span></span><code>参考<span class="w"> </span>https://github.com/NVIDIA-AI-IOT/jetbot/wiki/Create-SD-Card-Image-From-Scratch
$<span class="w"> </span>sudo<span class="w"> </span>usermod<span class="w"> </span>-aG<span class="w"> </span>i2c<span class="w"> </span><span class="nv">$USER</span><span class="w"> </span>//启用<span class="w"> </span>i2c<span class="w"> </span>权限<span class="w"> </span>-&gt;<span class="w"> </span>oled屏显示ip等
$<span class="w"> </span>pip3<span class="w"> </span>install<span class="w"> </span>traitlets<span class="w"> </span>--timeout<span class="o">=</span><span class="m">3600</span><span class="w"> </span>//安装<span class="w"> </span>traitlets：动态监听回调功能
<span class="w">    </span>//按jetbot官方安装方式，报错，故再采用https://github.com/ipython/traitlets上安装方式

输出信息：
Collecting<span class="w"> </span>traitlets
<span class="w">  </span>Using<span class="w"> </span>cached<span class="w"> </span>https://files.pythonhosted.org/packages/ca/ab/872a23e29cec3cf2594af7e857f18b687ad21039c1f9b922fac5b9b142d5/traitlets-4.3.3-py2.py3-none-any.whl
Collecting<span class="w"> </span>decorator<span class="w"> </span><span class="o">(</span>from<span class="w"> </span>traitlets<span class="o">)</span>
<span class="w">  </span>Using<span class="w"> </span>cached<span class="w"> </span>https://files.pythonhosted.org/packages/3d/cc/d7b758e54779f7e465179427de7e78c601d3330d6c411ea7ba9ae2f38102/decorator-5.1.0-py3-none-any.whl
Collecting<span class="w"> </span>six<span class="w"> </span><span class="o">(</span>from<span class="w"> </span>traitlets<span class="o">)</span>
<span class="w">  </span>Using<span class="w"> </span>cached<span class="w"> </span>https://files.pythonhosted.org/packages/d9/5a/e7c31adbe875f2abbb91bd84cf2dc52d792b5a01506781dbcf25c91daf11/six-1.16.0-py2.py3-none-any.whl
Collecting<span class="w"> </span>ipython-genutils<span class="w"> </span><span class="o">(</span>from<span class="w"> </span>traitlets<span class="o">)</span>
<span class="w">  </span>Downloading<span class="w"> </span>https://files.pythonhosted.org/packages/fa/bc/9bd3b5c2b4774d5f33b2d544f1460be9df7df2fe42f352135381c347c69a/ipython_genutils-0.2.0-py2.py3-none-any.whl
Installing<span class="w"> </span>collected<span class="w"> </span>packages:<span class="w"> </span>decorator,<span class="w"> </span>six,<span class="w"> </span>ipython-genutils,<span class="w"> </span>traitlets
Successfully<span class="w"> </span>installed<span class="w"> </span>decorator-5.1.0<span class="w"> </span>ipython-genutils-0.2.0<span class="w"> </span>six-1.16.0<span class="w"> </span>traitlets-4.3.3<span class="w">  </span>
</code></pre></div>
<ul>
<li>
<p><strong>创建交换文件：避免内存耗尽</strong></p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>fallocate<span class="w"> </span>-l<span class="w"> </span>4G<span class="w"> </span>/var/swapfile<span class="w"> </span>//设置交换文件的大小为4G，当内存不够用时，会把它看成内存的交换文件
$<span class="w"> </span>sudo<span class="w"> </span>chmod<span class="w"> </span><span class="m">600</span><span class="w"> </span>/var/swapfile
$<span class="w"> </span>sudo<span class="w"> </span>mkswap<span class="w"> </span>/var/swapfile
$<span class="w"> </span>sudo<span class="w"> </span>swapon<span class="w"> </span>/var/swapfile
$<span class="w"> </span>sudo<span class="w"> </span>bash<span class="w"> </span>-c<span class="w"> </span><span class="s1">&#39;echo &quot;/var/swapfile swap swap defaults 0 0&quot; &gt;&gt; /etc/fstab&#39;</span>
</code></pre></div>
</li>
<li>
<p>安装 jupyter</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>nodejs<span class="w"> </span>npm<span class="w">   </span>
$<span class="w"> </span>sudo<span class="w"> </span>pip3<span class="w"> </span>install<span class="w"> </span>jupyter<span class="w"> </span>jupyterlab<span class="w"> </span>//安装jupyter
<span class="w">   </span>//问题：<span class="w"> </span>下载太慢，用新的源地址
<span class="w">   </span>//解决：<span class="w"> </span>sudo<span class="w"> </span>pip3<span class="w"> </span>install<span class="w"> </span>jupyter<span class="w"> </span>jupyterlab<span class="w"> </span>-i<span class="w"> </span>https://pypi.tuna.tsinghua.edu.cn/simple
<span class="w">  </span>//报错:<span class="w"> </span>Did<span class="w"> </span>not<span class="w"> </span>find<span class="w"> </span>libzmq<span class="w"> </span>via<span class="w"> </span>pkg-config
<span class="w">  </span>//<span class="w"> </span>$<span class="w"> </span>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>libzmq3-dev
<span class="w">  </span>//<span class="w"> </span>报错：<span class="w"> </span>_cffi_backend.c:15:10:<span class="w"> </span>fatal<span class="w"> </span>error:<span class="w"> </span>ffi.h:<span class="w"> </span>No<span class="w"> </span>such<span class="w"> </span>file<span class="w"> </span>or<span class="w"> </span>directory
<span class="w">  </span>//<span class="w"> </span>$<span class="w"> </span>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>libffi-dev
<span class="w">  </span>//<span class="w"> </span>问题：安装时间长，超时了，加--timeout<span class="o">=</span><span class="m">3600</span><span class="w"> </span>可以重新运行试试<span class="w">  </span>
<span class="w">  </span>//<span class="w"> </span>问题：下载慢，终止，重新运行几次试试，可能某次连接会较快
<span class="w">  </span>//<span class="w"> </span>问题：如果板子死机ssh断开，
<span class="w">  </span>//<span class="w">     </span>如<span class="w"> </span>ssh:<span class="w"> </span>connect<span class="w"> </span>to<span class="w"> </span>host<span class="w"> </span><span class="m">192</span>.168.10.237<span class="w"> </span>port<span class="w"> </span><span class="m">22</span>:<span class="w"> </span>Connection<span class="w"> </span>refused
<span class="w">  </span>//<span class="w">     </span>则重启板子，重联
$<span class="w"> </span>sudo<span class="w"> </span>jupyter<span class="w"> </span>labextension<span class="w"> </span>install<span class="w"> </span>@jupyter-widgets/jupyterlab-manager<span class="w"> </span>
<span class="w">  </span>//<span class="w"> </span>报错：ValueError:<span class="w"> </span>Please<span class="w"> </span>install<span class="w"> </span>nodejs<span class="w"> </span>&gt;<span class="o">=</span><span class="m">12</span>.0.0<span class="w"> </span>before<span class="w"> </span>continuing.
<span class="w">  </span>//<span class="w"> </span>解决：安装最新版的node<span class="w">  </span>
<span class="w">  </span>//<span class="w">  </span>https://nodejs.org/en/download/<span class="w"> </span>下载<span class="w"> </span>ARMv8版<span class="w">  </span>
<span class="w">  </span>//<span class="w"> </span>然后再用scp<span class="w"> </span>命令传输即可
<span class="w">  </span>//<span class="w">  </span>因<span class="w"> </span>jetson<span class="w"> </span>用CPU<span class="w"> </span>是ARM<span class="w">  </span>Cortex-A57<span class="w">  </span><span class="o">(</span>64位ARMv8-A架构<span class="o">)</span>
<span class="w">  </span>//$<span class="w"> </span>tar<span class="w"> </span>-xvf<span class="w"> </span>node-v14.18.1-linux-arm64.tar.xz
<span class="w">  </span>//$<span class="w"> </span>sudo<span class="w"> </span>ln<span class="w"> </span>-s<span class="w"> </span>/home/yhbd/env/node-v14.18.1-linux-arm64/bin/npm<span class="w"> </span>/usr/local/bin/
<span class="w">  </span>//$<span class="w"> </span>sudo<span class="w"> </span>ln<span class="w"> </span>-s<span class="w"> </span>/home/yhbd/env/node-v14.18.1-linux-arm64/bin/node<span class="w"> </span>/usr/local/bin/
$<span class="w"> </span>sudo<span class="w"> </span>jupyter<span class="w"> </span>labextension<span class="w"> </span>install<span class="w"> </span>@jupyterlab/statusbar
$<span class="w"> </span>jupyter<span class="w"> </span>lab<span class="w"> </span>--generate-config
$<span class="w"> </span>jupyter<span class="w"> </span>notebook<span class="w"> </span>password<span class="w"> </span>//输入密码<span class="w"> </span>yhai
</code></pre></div>
<blockquote>
<ul>
<li>
<p>问题1：</p>
<p><code>python3 -m pip install --user --upgrade pip</code></p>
<p>解决：<code>Command "python setup.py egg_info" failed with error code 1 in /tmp/pip-build-bs0nzrvw/pyzmq/</code></p>
<p><code>pip3 install django-mdeditor==0.1.13</code></p>
</li>
<li>
<p>问题2：npm、node的版本</p>
<blockquote>
<p>根据你的描述，当前 <code>/opt</code> 目录下确实没有 Node.js 的安装。以下是针对 Jetson Nano (ARM64) 的 <strong>完整修复流程</strong>，包含路径重建和权限修复：</p>
<hr />
<h3 id="1-nodejs"><strong>步骤 1：重建 Node.js 安装目录</strong></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># 创建专用安装目录并赋权</span>
sudo<span class="w"> </span>mkdir<span class="w"> </span>-p<span class="w"> </span>/opt/node
sudo<span class="w"> </span>chown<span class="w"> </span>-R<span class="w"> </span><span class="nv">$USER</span>:<span class="nv">$USER</span><span class="w"> </span>/opt/node<span class="w">  </span><span class="c1"># 将目录所有权赋予当前用户</span>
</code></pre></div>
<h3 id="2-nodejs-v16202"><strong>步骤 2：重新安装 Node.js v16.20.2</strong></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># 下载官方 ARM64 二进制包（确认架构正确）</span>
wget<span class="w"> </span>https://nodejs.org/dist/v16.20.2/node-v16.20.2-linux-arm64.tar.xz

<span class="c1"># 解压到临时目录</span>
tar<span class="w"> </span>-xvf<span class="w"> </span>node-v16.20.2-linux-arm64.tar.xz

<span class="c1"># 将内容移动到 /opt/node（保留版本号目录结构）</span>
mv<span class="w"> </span>node-v16.20.2-linux-arm64<span class="w"> </span>/opt/node/v16.20.2

<span class="c1"># 创建主版本软链接（方便未来升级）</span>
ln<span class="w"> </span>-s<span class="w"> </span>/opt/node/v16.20.2<span class="w"> </span>/opt/node/current
</code></pre></div>
<h3 id="3"><strong>步骤 3：配置系统级环境变量</strong></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># 编辑全局 profile 文件</span>
<span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;export PATH=&quot;/opt/node/current/bin:$PATH&quot;&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/etc/profile.d/nodejs.sh

<span class="c1"># 立即生效</span>
<span class="nb">source</span><span class="w"> </span>/etc/profile.d/nodejs.sh

<span class="c1"># 验证路径</span>
<span class="nb">echo</span><span class="w"> </span><span class="nv">$PATH</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="s1">&#39;/opt/node/current/bin&#39;</span><span class="w">  </span><span class="c1"># 应显示在路径中</span>
</code></pre></div>
<h3 id="4-sudo"><strong>步骤 4：修复 sudo 环境识别</strong></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># 创建系统级符号链接（让 sudo 能找到命令）</span>
sudo<span class="w"> </span>ln<span class="w"> </span>-sf<span class="w"> </span>/opt/node/current/bin/node<span class="w"> </span>/usr/local/bin/node
sudo<span class="w"> </span>ln<span class="w"> </span>-sf<span class="w"> </span>/opt/node/current/bin/npm<span class="w"> </span>/usr/local/bin/npm

<span class="c1"># 验证符号链接</span>
ls<span class="w"> </span>-l<span class="w"> </span>/usr/local/bin/node<span class="w"> </span>/usr/local/bin/npm
<span class="c1"># 正确输出应类似：</span>
<span class="c1"># lrwxrwxrwx 1 root root 25 May 20 10:00 /usr/local/bin/node -&gt; /opt/node/current/bin/node</span>
</code></pre></div>
<h3 id="5"><strong>步骤 5：验证安装</strong></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># 普通用户验证</span>
node<span class="w"> </span>-v<span class="w">  </span><span class="c1"># 应输出 v16.20.2</span>
npm<span class="w"> </span>-v<span class="w">   </span><span class="c1"># 应输出 8.19.4</span>

<span class="c1"># sudo 环境验证</span>
sudo<span class="w"> </span>node<span class="w"> </span>-v<span class="w">  </span><span class="c1"># 应与普通用户一致</span>
sudo<span class="w"> </span>npm<span class="w"> </span>-v
</code></pre></div>
<hr />
<h3 id="_12"><strong>关键目录结构</strong></h3>
<div class="highlight"><pre><span></span><code>/opt/node/
├── v16.20.2/           # 版本化安装目录
│   ├── bin/            # 包含 node、npm 等可执行文件
│   ├── include/
│   └── lib/
└── current -&gt; v16.20.2  # 软链接指向当前版本
</code></pre></div>
<hr />
<h3 id="_13"><strong>故障排查</strong></h3>
<ol>
<li>
<p><strong>若出现 <code>GLIBC_2.28</code> 错误</strong><br />
   确认 Jetson Nano 的 Ubuntu 版本：
   <div class="highlight"><pre><span></span><code>lsb_release<span class="w"> </span>-a
<span class="c1"># Ubuntu 18.04 对应 GLIBC 2.27，必须使用 Node.js v16.x</span>
</code></pre></div></p>
</li>
<li>
<p><strong>权限问题修复</strong><br />
   <div class="highlight"><pre><span></span><code><span class="c1"># 递归修改 /opt/node 所有权</span>
sudo<span class="w"> </span>chown<span class="w"> </span>-R<span class="w"> </span><span class="nv">$USER</span>:<span class="nv">$USER</span><span class="w"> </span>/opt/node

<span class="c1"># 确保可执行权限</span>
sudo<span class="w"> </span>chmod<span class="w"> </span>-R<span class="w"> </span><span class="m">755</span><span class="w"> </span>/opt/node/current/bin/*
</code></pre></div></p>
</li>
<li>
<p><strong>环境变量未生效</strong><br />
   手动指定路径执行：
   <div class="highlight"><pre><span></span><code>/opt/node/current/bin/node<span class="w"> </span>-v
/opt/node/current/bin/npm<span class="w"> </span>-v
</code></pre></div></p>
</li>
</ol>
<hr />
<h3 id="_14"><strong>长期维护建议</strong></h3>
<ol>
<li>
<p><strong>版本升级路径</strong><br />
   未来升级 Node.js 时：
   <div class="highlight"><pre><span></span><code><span class="c1"># 下载新版本到 /opt/node/vX.X.X</span>
<span class="c1"># 修改 current 软链接</span>
ln<span class="w"> </span>-sfn<span class="w"> </span>/opt/node/vX.X.X<span class="w"> </span>/opt/node/current
</code></pre></div></p>
</li>
<li>
<p><strong>使用 NPM 全局包专用目录</strong><br />
   <div class="highlight"><pre><span></span><code><span class="c1"># 配置 npm 全局包存储位置</span>
npm<span class="w"> </span>config<span class="w"> </span><span class="nb">set</span><span class="w"> </span>prefix<span class="w"> </span><span class="s1">&#39;/opt/node/current/.npm-global&#39;</span>

<span class="c1"># 添加路径到环境变量</span>
<span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;export PATH=&quot;/opt/node/current/.npm-global/bin:$PATH&quot;&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>-a<span class="w"> </span>/etc/profile.d/nodejs.sh
<span class="nb">source</span><span class="w"> </span>/etc/profile.d/nodejs.sh
</code></pre></div></p>
</li>
</ol>
<hr />
<p>完成上述步骤后，你的 Node.js 环境将完全修复且与系统深度集成。此方案专为 ARM64 设备（如 Jetson Nano）设计，避免了 GLIBC 版本冲突和权限问题。</p>
</blockquote>
</li>
</ul>
</blockquote>
</li>
<li>
<p>源码安装jetbot</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>python3-smbus
$<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/NVIDIA-AI-IOT/jetbot<span class="w">  </span>//下载jetbot源码
$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>jetbot
$<span class="w"> </span>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>cmake
$<span class="w"> </span>sudo<span class="w"> </span>python3<span class="w"> </span>setup.py<span class="w"> </span>install<span class="w"> </span>
<span class="w">   </span>//报错：ssd_tensorrt/FlattenConcat.cpp:277:58:<span class="w"> </span>error:<span class="w"> </span>invalid<span class="w"> </span>new-expression<span class="w"> </span>of<span class="w"> </span>abstract<span class="w"> </span>class<span class="w"> </span><span class="nb">type</span><span class="w"> </span>‘FlattenConcat’
<span class="w">  </span>//<span class="w"> </span>build.make:62:<span class="w"> </span>recipe<span class="w"> </span><span class="k">for</span><span class="w"> </span>target<span class="w">    </span><span class="s1">&#39;jetbot/ssd_tensorrt/CMakeFiles/ssd_tensorrt.dir/FlattenConcat.cpp.o&#39;</span><span class="w"> </span>failed
<span class="w">   </span>//setuptools&gt;<span class="o">=</span><span class="m">42</span><span class="w"> </span>is<span class="w"> </span>required<span class="w"> </span><span class="k">for</span><span class="w"> </span>pyproject.toml<span class="w"> </span>configuration<span class="w"> </span>support
<span class="w">   </span>//ERROR:<span class="w"> </span><span class="nv">setuptools</span><span class="o">==</span><span class="m">39</span>.0.1<span class="w"> </span>is<span class="w"> </span>used<span class="w"> </span><span class="k">in</span><span class="w"> </span>combination<span class="w"> </span>with<span class="w"> </span>setuptools_scm&gt;<span class="o">=</span><span class="m">6</span>.x

<span class="w">   </span>//Your<span class="w"> </span>build<span class="w"> </span>configuration<span class="w"> </span>is<span class="w"> </span>incomplete<span class="w"> </span>and<span class="w"> </span>previously<span class="w"> </span>worked<span class="w"> </span>by<span class="w"> </span>accident!
注：<span class="w"> </span>没精力查，可暂时跳过，但需记录，可能埋下雷，
</code></pre></div>
</li>
<li>
<p>安装 jetbot 服务</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>jetbot/utils
$<span class="w"> </span>python3<span class="w"> </span>create_stats_service.py
$<span class="w"> </span>sudo<span class="w"> </span>mv<span class="w"> </span>jetbot_stats.service<span class="w"> </span>/etc/systemd/system/jetbot_stats.service
$<span class="w"> </span>sudo<span class="w"> </span>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>jetbot_stats<span class="w"> </span>//启动<span class="w"> </span>jetbot_stats<span class="w"> </span>服务
<span class="w">              </span>//systemctl:管理Linux的系统服务的命令<span class="o">(</span>替代service:<span class="w"> </span>串行启动<span class="w"> </span>慢）
$<span class="w"> </span>sudo<span class="w"> </span>systemctl<span class="w"> </span>start<span class="w"> </span>jetbot_stats
$<span class="w"> </span>python3<span class="w"> </span>create_jupyter_service.py
$<span class="w"> </span>sudo<span class="w"> </span>mv<span class="w"> </span>jetbot_jupyter.service<span class="w"> </span>/etc/systemd/system/jetbot_jupyter.service
$<span class="w"> </span>sudo<span class="w"> </span>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>jetbot_jupyter
$<span class="w"> </span>sudo<span class="w"> </span>systemctl<span class="w"> </span>start<span class="w"> </span>jetbot_jupyter<span class="w">   </span>
$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>..
$<span class="w"> </span>cp<span class="w"> </span>-rf<span class="w"> </span>notebooks/<span class="w"> </span>~/<span class="w">  </span>//拷贝jetbot的测试示例程序<span class="w"> </span>到主目录，方便使用
</code></pre></div>
</li>
<li>
<p>验证</p>
<div class="highlight"><pre><span></span><code>网页登录<span class="w"> </span>http://192.168.10.237:8888/<span class="w"> </span>输入密码yhai
打开<span class="w"> </span>notebooks/basic_motion/basic_motion.ipynb<span class="w"> </span>//逐步运行，发现能控制小车，表示基本成功
<span class="w">                       </span>//注意小车电源开关要打开哦
</code></pre></div>
</li>
</ul>
<h3 id="tensorflow">tensorflow</h3>
<p><strong>TODO</strong></p>
<h3 id="_15">远程登陆编辑</h3>
<div class="highlight"><pre><span></span><code>点田字形状<span class="o">(</span>左侧边栏里<span class="o">)</span><span class="w"> </span>-&gt;<span class="w"> </span>搜Remote<span class="w"> </span>Development<span class="w"> </span>安装
<span class="w">                                  </span>搜Remote<span class="w"> </span>SSH安装
点电脑形状<span class="o">(</span>左侧边栏里<span class="o">)</span><span class="w"> </span>-&gt;<span class="w"> </span>远程资源管理器里<span class="w"> </span>选SSH<span class="w"> </span>Targets<span class="w"> </span>
<span class="w">      </span>-&gt;<span class="w"> </span>点设置<span class="o">(</span>齿轮形<span class="o">)</span><span class="w">  </span>-&gt;<span class="w"> </span>选ss配置文件<span class="o">(</span>如/home/yhai/.ssh/config<span class="o">)</span><span class="w">  </span>
<span class="w">      </span>-&gt;<span class="w"> </span>更改hostname为要登录电脑的ip<span class="w"> </span><span class="o">(</span>如192.168.10.237<span class="o">)</span>
<span class="w">      </span>-&gt;<span class="w"> </span>把user<span class="w"> </span>改为要远程登录的用户名<span class="o">(</span>如jetbot<span class="o">)</span><span class="w"> </span>

点田字形状<span class="w"> </span>-&gt;<span class="w"> </span>点Remote<span class="w"> </span>SSH<span class="w"> </span>下脚的小齿轮<span class="w"> </span>-&gt;<span class="w"> </span>扩展设置<span class="w"> </span>-&gt;<span class="w"> </span>在settings.json中编辑<span class="w"> </span>
<span class="w">     </span>-&gt;<span class="w">  </span>在里面添加一行<span class="w">  </span><span class="s2">&quot;remote.SSH.useLocalServer&quot;</span>:<span class="w"> </span>true,<span class="w">   </span>
<span class="w">     </span>//解决链接报错<span class="w">    </span>“remote.SSH.useLocalServer”:<span class="w"> </span><span class="nb">false</span>

点电脑形状<span class="o">(</span>左侧边栏里<span class="o">)</span><span class="w"> </span>-&gt;<span class="w"> </span>选SSH<span class="w"> </span>Targets<span class="w"> </span>
<span class="w">  </span>-&gt;<span class="w"> </span>点alias电脑图标<span class="w"> </span>-&gt;右键选<span class="w"> </span>connect<span class="w"> </span>to<span class="w"> </span>host<span class="w"> </span><span class="k">in</span><span class="w"> </span>new<span class="w"> </span>window<span class="w"> </span>
<span class="w">  </span>-&gt;<span class="w"> </span>成功看到<span class="w"> </span>已连接远程<span class="w"> </span>-&gt;<span class="w"> </span>点打开文件<span class="w"> </span>，选则远程服务器上<span class="w"> </span>代码<span class="w"> </span>映射到本地来编辑
<span class="w">               </span>//会自动提示装插件，如当你看到dts文件时提示按照Device<span class="w"> </span>Tree的<span class="w"> </span>插件<span class="w">  </span>如

下面终端可运行程序<span class="w">  </span>//如果看不到终端，可能隐藏了，用鼠标在下边框往上拉一下
<span class="w">                   </span>//或点上面的终端，新建终端
<span class="w"> </span>jetbot@nano-4gb-jp45:~$<span class="w">  </span>
</code></pre></div>
<h3 id="_16">远程代码提示</h3>
<div class="highlight"><pre><span></span><code>选SSH<span class="w"> </span>Targets<span class="w"> </span>-&gt;<span class="w"> </span>点alias电脑图标<span class="w">  </span>//确保安装插件位置是再运程板子上<span class="w"> </span>（不是本地）<span class="w">    </span>
<span class="w">                                 </span>//要在“SSH:<span class="w"> </span>alias”上启用<span class="w"> </span>扩展<span class="w"> </span>
点田字形状<span class="w"> </span>-&gt;<span class="w"> </span>搜Python<span class="w"> </span>-&gt;<span class="w"> </span>点“在SSH:<span class="w"> </span>alias中安装”<span class="w"> </span>
<span class="w">              </span>搜Python<span class="w"> </span><span class="k">for</span><span class="w"> </span>VSCode<span class="w"> </span>安装
<span class="w">              </span>搜Python<span class="w"> </span>Extension<span class="w"> </span>Pack<span class="w"> </span>安装
<span class="w">              </span>搜kite<span class="w"> </span>安装<span class="w">   </span>//AI<span class="w"> </span>智能提示
//验证代码提示功能<span class="w"> </span>
<span class="w"> </span>打开<span class="w"> </span>a.py<span class="w">  </span>-&gt;<span class="w">  </span>输入下面代码
<span class="w">   </span>import<span class="w"> </span><span class="nb">time</span>
<span class="w">   </span>time.sl<span class="w">    </span>//能提示<span class="w"> </span>sleep
<span class="w">   </span>import<span class="w">  </span>cv2
<span class="w">   </span>cv2.imr<span class="w">    </span>//能提示<span class="w"> </span>cv2.imread<span class="w">  </span>

//第三方源码库提示<span class="o">(</span>如jetbot<span class="o">)</span>
<span class="w"> </span>文件<span class="w"> </span>-&gt;<span class="w"> </span>首选项<span class="w"> </span>-&gt;<span class="w"> </span>设置<span class="w"> </span>-&gt;<span class="w"> </span>点用户<span class="w"> </span>-&gt;<span class="w"> </span>搜python<span class="w"> </span>-&gt;点击<span class="s2">&quot;在settings.json中编辑&quot;</span>
<span class="w">    </span>在里面添加第三方源码的路径<span class="w"> </span>//如/home/jetbot/jetbot
<span class="w">          </span><span class="s2">&quot;python.autoComplete.addBrackets&quot;</span>:<span class="w"> </span>true,
<span class="w">          </span><span class="s2">&quot;python.autoComplete.extraPaths&quot;</span>:<span class="w"> </span><span class="o">[</span><span class="s2">&quot;/home/jetbot/jetbot&quot;</span><span class="o">]</span>,<span class="w">  </span>
<span class="w"> </span>重启<span class="w"> </span>VSCODE,再尝试
<span class="w">  </span>from<span class="w"> </span>jetbot<span class="w"> </span>import<span class="w"> </span>Robot
<span class="w">    </span><span class="nv">robot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>Robot<span class="o">()</span>
<span class="w">  </span>robot.le<span class="w">   </span>//就能自动补全left了
</code></pre></div>
<h3 id="_17">浏览器远程控制</h3>
<div class="highlight"><pre><span></span><code>Jupyter //在浏览器上，可远程编程运行，写笔记，界面控制。
        //适用场合： 教学，简单演示，不适合用来开发软件
        //优点: 实现远程浏览器控制，很方便（需界面显示时，无需接hdmi显示屏）
        // 1. 基于Web的shell，随时随地可以运行、调试代码；
        // 2. 支持markdown，文本式编程，特别适合做电子教材 
        // 3. 基于ipython，浏览器可编写交互界面如ipywidgets  
        //缺点：容易卡死，不能看到程序运行的过程信息。编辑功能比不上vscode等。
</code></pre></div>
<h2 id="_18">镜像备份和还原</h2>
<h3 id="_19">镜像备份</h3>
<div class="highlight"><pre><span></span><code>sd卡插入电脑<span class="w"> </span>-&gt;<span class="w"> </span>虚拟机<span class="w"> </span>-&gt;<span class="w"> </span>可移动设备<span class="w"> </span>-&gt;<span class="w"> </span>选<span class="w"> </span>Super<span class="w"> </span>Top<span class="w">  </span>-&gt;<span class="w"> </span>连接<span class="w"> </span>//让SD卡连接到虚拟机中

$<span class="w"> </span>df<span class="w"> </span>-h<span class="w">  </span>//可看到<span class="w"> </span>有<span class="w"> </span>/dev/sdb1<span class="w"> </span>挂载
<span class="w">  </span>/dev/sdb1<span class="w">   </span>118G<span class="w">   </span>21G<span class="w">   </span>92G<span class="w">   </span><span class="m">19</span>%<span class="w"> </span>/media/yhai/b1c100cd-cc74-4e7f-acb8<span class="w">    </span>
//压缩备份SD卡镜像<span class="o">(</span>3个小时以上<span class="o">)</span>
$<span class="w"> </span>sudo<span class="w"> </span>dd<span class="w"> </span><span class="k">if</span><span class="o">=</span>/dev/sdb<span class="w"> </span><span class="nv">conv</span><span class="o">=</span>sync,noerror<span class="w"> </span><span class="nv">bs</span><span class="o">=</span>4M<span class="w"> </span><span class="p">|</span><span class="w"> </span>gzip<span class="w"> </span>-c<span class="w"> </span>&gt;<span class="w"> </span>~/backup_image.img.gz<span class="w"> </span>

$<span class="w"> </span>sudo<span class="w"> </span>pkill<span class="w"> </span>-USR1<span class="w"> </span>-n<span class="w"> </span>-x<span class="w"> </span>dd<span class="w"> </span>//需在新窗口中执行，激活进度信息，再回到原窗口，就能看到进度信息了
//每次查看都要执行一次，128G卡要，把128G全部读完才成功，成功后可ls<span class="w"> </span>-lh<span class="w"> </span>查看大小，我的是11G左右
</code></pre></div>
<h3 id="_20">镜像还原</h3>
<div class="highlight"><pre><span></span><code>//格式化
用usb读卡器把待还原的sd卡插入电脑<span class="w"> </span>//<span class="w"> </span>注意要用高速sd卡<span class="o">(</span>如闪迪tf卡Extreme<span class="o">)</span>，否则烧写很慢
打开SD<span class="w"> </span>Card<span class="w"> </span>Formatter<span class="w">  </span>-&gt;<span class="w"> </span>Select<span class="w"> </span>card<span class="w"> </span>选SD卡<span class="w">  </span>//注意：千万别选错了，把别的盘格式了
-&gt;<span class="w"> </span>选Quick<span class="w"> </span>format<span class="w"> </span>-&gt;<span class="w"> </span>让Volume<span class="w"> </span>label空白<span class="w"> </span>-&gt;<span class="w"> </span>点Format

//还原：<span class="w"> </span>烧写<span class="o">(</span>需确认<span class="w"> </span>/dev/sdb<span class="w"> </span>是新插入的SD卡<span class="w"> </span><span class="o">)</span>，时间3小时左右
$<span class="w"> </span>sudo<span class="w"> </span>gunzip<span class="w"> </span>-dc<span class="w"> </span>backup_image.img.gz<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>dd<span class="w"> </span><span class="nv">of</span><span class="o">=</span>/dev/sdb<span class="w"> </span><span class="nv">bs</span><span class="o">=</span>4M<span class="w"> </span>

//查看进度：需在新窗口中执行，激活进度信息，再回到原窗口，就能看到进度信息了
//<span class="w">    </span>每次查看都要执行一次，128G卡要，把128G全部写完才成功，
$<span class="w"> </span>sudo<span class="w"> </span>pkill<span class="w"> </span>-USR1<span class="w"> </span>-n<span class="w"> </span>-x<span class="w"> </span>dd<span class="w"> </span>

//验证
烧写成功后，把sd卡插入到小车，看能成功启动否
</code></pre></div>
<h2 id="_21">源码分析</h2>
<p>移植和软件开发的基础 就是源码分析。</p>
<p>核心问题：版本不匹配、安装速度慢、API</p>
<h3 id="cmake">CMake</h3>
<blockquote>
<ol>
<li>官方文档：https://cmake.org/cmake/help/latest/</li>
<li>现代CMake教程：https://modern-cmake-cn.github.io/CMake-tutorial-zh-Hans/</li>
<li>进阶书籍：《Professional CMake: A Practical Guide》</li>
</ol>
</blockquote>
<h4 id="hello-world">hello world</h4>
<div class="highlight"><pre><span></span><code><span class="err">//环境安装</span>
<span class="err">$</span><span class="w"> </span><span class="err">sudo</span><span class="w"> </span><span class="err">apt</span><span class="w"> </span><span class="err">install</span><span class="w"> </span><span class="err">cmake</span><span class="w">  </span><span class="err">//安装</span>
<span class="w">  </span><span class="err">cmake</span><span class="w"> </span><span class="err">已经是最新版</span><span class="w"> </span><span class="err">(3.10.2-1ubuntu2.18.04.2)//默认jetson</span><span class="w"> </span><span class="err">nano已安装</span>
<span class="err">$</span><span class="w"> </span><span class="err">cmake</span><span class="w"> </span><span class="err">-version</span><span class="w">  </span><span class="err">//查看版本</span>
<span class="w">  </span><span class="err">cmake</span><span class="w"> </span><span class="err">version</span><span class="w"> </span><span class="err">3.10.2</span><span class="w">  </span>

<span class="err">//main.c</span>
<span class="c">#include &lt;stdio.h&gt;</span>

<span class="err">int</span><span class="w"> </span><span class="err">main(void)</span>
<span class="err">{</span>
<span class="w">   </span><span class="err">printf(</span><span class="s2">&quot;Hello World\n&quot;</span><span class="err">);</span>
<span class="w">   </span><span class="err">return</span><span class="w"> </span><span class="err">0;</span>
<span class="err">}</span><span class="w">   </span>
<span class="err">//CMakeLists.txt</span>
<span class="err">cmake_minimum_required</span><span class="w"> </span><span class="err">(VERSION</span><span class="w"> </span><span class="err">2.8)</span><span class="w"> </span><span class="c">#// cmake的最低版本要求是2.8，我们安装的是3.10.2</span>
<span class="err">project</span><span class="w"> </span><span class="err">(demo)</span><span class="w"> </span><span class="c">#//工程名</span>
<span class="err">add_executable(main</span><span class="w"> </span><span class="err">main.c)</span><span class="w">  </span><span class="c">#//由源文件main.c 生成执行文件main</span>

<span class="err">//编译运行</span>
<span class="err">$</span><span class="w"> </span><span class="err">cmake</span><span class="w"> </span><span class="err">.</span><span class="w"> </span><span class="err">//在当前目录，自动构建本平台编译需要的文件</span>
<span class="w">          </span><span class="err">//自动生成文件有</span><span class="w"> </span><span class="err">CMakeCache.txt</span><span class="w">  </span><span class="err">CMakeFiles</span><span class="w">  </span><span class="err">cmake_install.cmake</span><span class="w"> </span><span class="err">Makefile</span>
<span class="err">$</span><span class="w"> </span><span class="err">make</span><span class="w">    </span><span class="err">//编译文件(用已自动生成的Makefile文件)</span>
<span class="err">$</span><span class="w"> </span><span class="err">./main</span><span class="w">  </span><span class="err">//运行执行程序</span>
<span class="err">$</span><span class="w"> </span><span class="err">make</span><span class="w"> </span><span class="err">clean</span><span class="w"> </span><span class="err">//清楚编译中的生成文件(如</span><span class="w"> </span><span class="err">main.o</span><span class="w"> </span><span class="err">main)</span>
</code></pre></div>
<h4 id="_22">多文件</h4>
<div class="highlight"><pre><span></span><code>//main.c
#include &lt;stdio.h&gt;
#include &quot;fun.h&quot;
int main(void)
{ 
  show(10);
  return 0;
}   
//fun.h
#ifndef _FUN_H_
#define _FUN_H_
void show(int data);
#endif  

//fun.c
#include &lt;stdio.h&gt;
#include &quot;fun.h&quot;
void show(int data)
{
   printf(&quot;data is %d\n&quot;, data);
}   

//CMakeLists.txt 版本1 -&gt; 直接指定源文件
cmake_minimum_required (VERSION 2.8) #// cmake的最低版本要求是2.8，我们安装的是3.10.2
project (demo) #//工程名
add_executable(main main.c fun.c) #//根据源文件main.c fun.c 生成执行文件main

//CMakeLists.txt 版本2 -&gt; 用变量 存放编译需要的源文件
cmake_minimum_required (VERSION 2.8) #// cmake的最低版本要求是2.8，我们安装的是3.10.2
project (demo) #//工程名
set( SRC_LIST  #//用变量，存放的文件列表
     ./main.c
     ./fun.c
   )
add_executable(main ${SRC_LIST}) #//根据SRC_LIST中的源文件 生成执行文件main

//CMakeLists.txt 版本3 -&gt; 源文件很多时，不用逐个写
cmake_minimum_required (VERSION 2.8) #// cmake的最低版本要求是2.8，我们安装的是3.10.2
project (demo) #//工程名
aux_source_directory(. SRC_LIST) #//把当前目录下的源文件列表，存放到变量SRC_LIST里
add_executable(main ${SRC_LIST}) #//根据SRC_LIST中的源文件 生成执行文件main
</code></pre></div>
<h4 id="_23">多目录</h4>
<div class="highlight"><pre><span></span><code><span class="c1">//fun.h</span>
<span class="cp">#ifndef _FUN_H_</span>
<span class="cp">#define _FUN_H_</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">show</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">data</span><span class="p">);</span>
<span class="cp">#endif</span>

<span class="c1">//fun.c</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;fun.h&quot;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">show</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;data is %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">);</span>
<span class="p">}</span><span class="w">   </span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1">//look.h</span>
<span class="cp">#ifndef _LOOK_H_</span>
<span class="cp">#define _LOOK_H_</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">look</span><span class="p">();</span>

<span class="cp">#endif  </span>

<span class="c1">//look.c</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;look.h&quot;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">look</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;look go</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="p">}</span><span class="w">   </span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>//CMakeLists.txt 
cmake_minimum_required (VERSION 2.8) #// cmake的最低版本要求是2.8，我们安装的是3.10.2
project (demo) #//工程名

include_directories (fun look)  #//指定头文件的搜索路径（先fun目录，再look目录)

aux_source_directory (fun SRC_LIST_FUN)   #//把fun目录下的源文件列表，存放到变量SRC_LIST_FUN里
aux_source_directory (look SRC_LIST_LOOK) #//把look目录下的源文件列表，存放到变量SRC_LIST_LOOK里
add_executable (main main.c ${SRC_LIST_FUN} ${SRC_LIST_LOOK})
</code></pre></div>
<h4 id="_24">库生成</h4>
<div class="highlight"><pre><span></span><code><span class="c1">//build   构建时的中间文件</span>
<span class="c1">//lib     生成的库</span>
<span class="c1">//CMakeLists.txt</span>
<span class="n">cmake_minimum_required</span><span class="w"> </span><span class="p">(</span><span class="n">VERSION</span><span class="w"> </span><span class="mf">2.8</span><span class="p">)</span>
<span class="n">project</span><span class="w"> </span><span class="p">(</span><span class="n">demo</span><span class="p">)</span>
<span class="n">add_subdirectory</span><span class="w"> </span><span class="p">(</span><span class="n">lib_src</span><span class="p">)</span><span class="w"> </span>

<span class="c1">//lib_src/fun.h</span>
<span class="cp">#ifndef _FUN_H_</span>
<span class="cp">#define _FUN_H_</span>
<span class="kt">void</span><span class="w"> </span><span class="n">show</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">data</span><span class="p">);</span>
<span class="cp">#endif</span>
<span class="c1">//lib_src/fun.c</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;fun.h&quot;</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">show</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;data is %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">//lib_src/CMakeLists.txt</span>
<span class="n">aux_source_directory</span><span class="w"> </span><span class="p">(.</span><span class="w"> </span><span class="n">SRC_LIST</span><span class="p">)</span>
<span class="n">add_library</span><span class="w"> </span><span class="p">(</span><span class="n">fun_shared</span><span class="w"> </span><span class="n">SHARED</span><span class="w"> </span><span class="n">$</span><span class="p">{</span><span class="n">SRC_LIST</span><span class="p">})</span><span class="w"> </span><span class="err">#</span><span class="c1">//根据SRC_LIST的源文件，生成动态库fun_shared，</span>
<span class="n">add_library</span><span class="w"> </span><span class="p">(</span><span class="n">fun_static</span><span class="w"> </span><span class="n">STATIC</span><span class="w"> </span><span class="n">$</span><span class="p">{</span><span class="n">SRC_LIST</span><span class="p">})</span><span class="w"> </span><span class="err">#</span><span class="c1">//根据SRC_LIST的源文件，生成静态库fun_static，</span>
<span class="n">set_target_properties</span><span class="w"> </span><span class="p">(</span><span class="n">fun_shared</span><span class="w"> </span><span class="n">PROPERTIES</span><span class="w"> </span><span class="n">OUTPUT_NAME</span><span class="w"> </span><span class="s">&quot;fun&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">#</span><span class="c1">//设置库的属性（如输出库名 版本号等)</span>
<span class="n">set_target_properties</span><span class="w"> </span><span class="p">(</span><span class="n">fun_static</span><span class="w"> </span><span class="n">PROPERTIES</span><span class="w"> </span><span class="n">OUTPUT_NAME</span><span class="w"> </span><span class="s">&quot;fun&quot;</span><span class="p">)</span>
<span class="cp">#</span><span class="c1">//指定生成的库文件，存放在工程根目录下的lib目录</span>
<span class="n">set</span><span class="w"> </span><span class="p">(</span><span class="n">LIBRARY_OUTPUT_PATH</span><span class="w"> </span><span class="n">$</span><span class="p">{</span><span class="n">PROJECT_SOURCE_DIR</span><span class="p">}</span><span class="o">/</span><span class="n">lib</span><span class="p">)</span>

<span class="n">$</span><span class="w"> </span><span class="n">cd</span><span class="w"> </span><span class="n">build</span>
<span class="n">$</span><span class="w"> </span><span class="n">cmake</span><span class="w"> </span><span class="p">..</span><span class="w">   </span><span class="c1">//进到build 目录后再cmake构建，避免生成中间文件，污染了工程</span>
<span class="n">$</span><span class="w"> </span><span class="n">make</span>
<span class="n">$</span><span class="w"> </span><span class="n">ls</span><span class="w"> </span><span class="p">..</span><span class="o">/</span><span class="n">lib</span><span class="w">  </span><span class="c1">//生成的库文件，在lib目录下   </span>
<span class="w">   </span><span class="n">libfun</span><span class="p">.</span><span class="n">a</span><span class="w">  </span><span class="n">libfun</span><span class="p">.</span><span class="n">so</span><span class="w">  </span>
</code></pre></div>
<h4 id="_25">库使用</h4>
<div class="highlight"><pre><span></span><code><span class="c1">//bin</span>
<span class="c1">//build</span>
<span class="c1">//lib  待使用的库  </span>
<span class="w"> </span><span class="n">libfun</span><span class="p">.</span><span class="n">a</span><span class="w">  </span><span class="n">libfun</span><span class="p">.</span><span class="n">so</span><span class="w">   </span>

<span class="c1">//CMakeLists.txt</span>
<span class="n">cmake_minimum_required</span><span class="w"> </span><span class="p">(</span><span class="n">VERSION</span><span class="w"> </span><span class="mf">2.8</span><span class="p">)</span>
<span class="n">project</span><span class="w"> </span><span class="p">(</span><span class="n">demo</span><span class="p">)</span>
<span class="n">add_subdirectory</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="w">  </span>

<span class="c1">//include/fun.h  库的头文件</span>
<span class="cp">#ifndef _FUN_H_</span>
<span class="cp">#define _FUN_H_</span>
<span class="kt">void</span><span class="w"> </span><span class="n">show</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">data</span><span class="p">);</span>
<span class="cp">#endif  </span>

<span class="c1">//src/main.c</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;fun.h&quot;</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="n">show</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span><span class="w">   </span>

<span class="c1">//src/CMakeLists.txt</span>
<span class="n">aux_source_directory</span><span class="w"> </span><span class="p">(.</span><span class="w"> </span><span class="n">SRC_LIST</span><span class="p">)</span>
<span class="n">include_directories</span><span class="w"> </span><span class="p">(..</span><span class="o">/</span><span class="n">include</span><span class="p">)</span>
<span class="n">link_directories</span><span class="w"> </span><span class="p">(</span><span class="n">$</span><span class="p">{</span><span class="n">PROJECT_SOURCE_DIR</span><span class="p">}</span><span class="o">/</span><span class="n">lib</span><span class="p">)</span><span class="w"> </span><span class="err">#</span><span class="c1">//添加非标准的共享库搜索路径</span>
<span class="n">add_executable</span><span class="w"> </span><span class="p">(</span><span class="n">main</span><span class="w"> </span><span class="n">$</span><span class="p">{</span><span class="n">SRC_LIST</span><span class="p">})</span>
<span class="n">target_link_libraries</span><span class="w"> </span><span class="p">(</span><span class="n">main</span><span class="w"> </span><span class="n">fun</span><span class="p">)</span><span class="w">  </span><span class="err">#</span><span class="c1">//连接库(默认链接动态库，无则链接静态库,也可指明链接fun.a)</span>
<span class="n">set</span><span class="w"> </span><span class="p">(</span><span class="n">EXECUTABLE_OUTPUT_PATH</span><span class="w"> </span><span class="n">$</span><span class="p">{</span><span class="n">PROJECT_SOURCE_DIR</span><span class="p">}</span><span class="o">/</span><span class="n">bin</span><span class="p">)</span>
</code></pre></div>
<h4 id="_26">标准结构</h4>
<div class="highlight"><pre><span></span><code><span class="c1">//bin 输出的执行文件</span>
<span class="c1">//build 存放构建中的中间文件</span>
<span class="c1">//lib  库</span>
<span class="w">   </span><span class="n">libfun</span><span class="p">.</span><span class="n">a</span><span class="w">  </span><span class="n">libfun</span><span class="p">.</span><span class="n">so</span>

<span class="c1">//CMakeLists.txt   cmake的总配置文件</span>
<span class="n">cmake_minimum_required</span><span class="w"> </span><span class="p">(</span><span class="n">VERSION</span><span class="w"> </span><span class="mf">2.8</span><span class="p">)</span><span class="w"> </span><span class="err">#</span><span class="c1">// cmake的最低版本要求是2.8，我们安装的是3.10.2</span>
<span class="n">project</span><span class="w"> </span><span class="p">(</span><span class="n">demo</span><span class="p">)</span><span class="w"> </span><span class="err">#</span><span class="c1">//工程名</span>
<span class="n">add_subdirectory</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="w"> </span><span class="err">#</span><span class="c1">//添加子目录(自动构建时，会进入src中找 子CMakeLists.txt)</span>

<span class="c1">//include/fun.h</span>
<span class="cp">#ifndef _FUN_H_</span>
<span class="cp">#define _FUN_H_</span>
<span class="kt">void</span><span class="w"> </span><span class="n">show</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">data</span><span class="p">);</span>
<span class="cp">#endif</span>
<span class="c1">//include/look.h</span>
<span class="cp">#ifndef _LOOK_H_</span>
<span class="cp">#define _LOOK_H_</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">look</span><span class="p">();</span>
<span class="cp">#endif</span>

<span class="c1">//src/main.c</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;fun.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;look.h&quot;</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">show</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="w">  </span><span class="n">look</span><span class="p">();</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span><span class="w">   </span>

<span class="c1">//src/look.c</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;look.h&quot;</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">look</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;look go</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="p">}</span><span class="w">   </span>

<span class="c1">//src/CMakeLists.txt  cmake的子配置文件</span>
<span class="n">aux_source_directory</span><span class="w"> </span><span class="p">(.</span><span class="w"> </span><span class="n">SRC_LIST</span><span class="p">)</span><span class="w"> </span><span class="err">#</span><span class="c1">//把当前目录下的源文件列表，存放到变量SRC_LIST里</span>
<span class="n">include_directories</span><span class="w"> </span><span class="p">(..</span><span class="o">/</span><span class="n">include</span><span class="p">)</span><span class="w">  </span><span class="err">#</span><span class="c1">//指定 上级目录下的include 为头文件的搜索路径</span>
<span class="n">link_directories</span><span class="w"> </span><span class="p">(</span><span class="n">$</span><span class="p">{</span><span class="n">PROJECT_SOURCE_DIR</span><span class="p">}</span><span class="o">/</span><span class="n">lib</span><span class="p">)</span><span class="w"> </span><span class="err">#</span><span class="c1">//添加库搜索路径</span>
<span class="n">add_executable</span><span class="w"> </span><span class="p">(</span><span class="n">main</span><span class="w"> </span><span class="n">$</span><span class="p">{</span><span class="n">SRC_LIST</span><span class="p">})</span><span class="w"> </span><span class="err">#</span><span class="c1">//根据SRC_LIST中的源文件 生成执行文件main</span>
<span class="n">target_link_libraries</span><span class="w"> </span><span class="p">(</span><span class="n">main</span><span class="w"> </span><span class="n">fun</span><span class="p">)</span><span class="w">  </span><span class="err">#</span><span class="c1">//连接库(默认链接动态库，无则链接静态库,也可指明链接fun.a)</span>
<span class="cp">#</span><span class="c1">//设定 执行文件的输出位置 为工程根目录下的bin目录</span>
<span class="n">set</span><span class="w"> </span><span class="p">(</span><span class="n">EXECUTABLE_OUTPUT_PATH</span><span class="w"> </span><span class="n">$</span><span class="p">{</span><span class="n">PROJECT_SOURCE_DIR</span><span class="p">}</span><span class="o">/</span><span class="n">bin</span><span class="p">)</span><span class="w">  </span>

<span class="c1">//构建运行</span>
<span class="n">$</span><span class="w"> </span><span class="n">cd</span><span class="w"> </span><span class="n">build</span>
<span class="n">$</span><span class="w"> </span><span class="n">cmake</span><span class="w"> </span><span class="p">..</span><span class="w">   </span><span class="c1">//进到build 目录后再cmake构建，避免生成中间文件，污染了工程</span>
<span class="n">$</span><span class="w"> </span><span class="n">make</span>
<span class="n">$</span><span class="w"> </span><span class="n">cd</span><span class="w"> </span><span class="p">..</span><span class="o">/</span><span class="n">bin</span><span class="w">  </span><span class="c1">//执行文件是输出到 bin下  </span>
<span class="n">$</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">main</span><span class="w">    </span>
</code></pre></div>
<blockquote>
<p>你遇到的问题是由于CMake缓存文件（CMakeCache.txt）中记录的原始构建路径与当前实际路径不一致导致的。这种情况通常发生在移动项目目录或错误地重复使用旧的构建目录时。以下是从问题分析到高级实践的完整解决方案：</p>
<hr />
<h3 id="_27">一、问题根本原因分析</h3>
<ol>
<li><strong>路径不一致错误</strong>：CMakeCache.txt文件记录了项目最初的构建路径（<code>/home/jai/test/standard/build</code>），但你现在尝试在<code>/home/jai/misc/test/CMake-test/standard/build</code>路径构建。</li>
<li><strong>缓存污染</strong>：CMake严格要求构建目录与缓存记录的路径一致，否则会引发二进制文件生成位置混乱。</li>
</ol>
<hr />
<h3 id="_28">二、立即解决方案</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># 进入构建目录</span>
<span class="nb">cd</span><span class="w"> </span>/home/jai/misc/test/CMake-test/standard/build

<span class="c1"># 彻底清理旧缓存（关键步骤！）</span>
rm<span class="w"> </span>-rf<span class="w"> </span>*

<span class="c1"># 重新生成构建系统（注意末尾的..表示CMakeLists.txt在上层目录）</span>
cmake<span class="w"> </span>..
</code></pre></div>
<hr />
<h3 id="cmake_1">三、CMake高级专业实践指南</h3>
<h4 id="1">1. 构建目录管理（核心原则）</h4>
<ul>
<li><strong>源外构建（Out-of-Source Build）</strong>：始终在独立目录中构建，与源码分离
  <div class="highlight"><pre><span></span><code>project_root/
├──<span class="w"> </span>CMakeLists.txt
├──<span class="w"> </span>src/
├──<span class="w"> </span>include/
└──<span class="w"> </span>build/<span class="w">  </span><span class="c1"># 专门创建的空目录用于构建</span>
</code></pre></div></li>
<li><strong>构建目录生命周期管理</strong>：
  <div class="highlight"><pre><span></span><code><span class="c1"># 每次代码更新后</span>
<span class="nb">cd</span><span class="w"> </span>build<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>cmake<span class="w"> </span>--build<span class="w"> </span>.<span class="w">  </span><span class="c1"># 增量编译</span>
<span class="c1"># 重大变更时</span>
rm<span class="w"> </span>-rf<span class="w"> </span>build<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>mkdir<span class="w"> </span>build<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>build<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>cmake<span class="w"> </span>..
</code></pre></div></li>
</ul>
<h4 id="2-cmake">2. 现代CMake项目结构（以你的目录为例）</h4>
<div class="highlight"><pre><span></span><code>project_root/
├── CMakeLists.txt           # 根配置文件
├── build/                   # 构建目录（建议.gitignore排除）
├── include/                 # 公共头文件
│   └── mylib/
│       └── header.h
├── src/                     # 源代码
│   ├── app/
│   │   └── main.cpp        # 可执行文件入口
│   └── mylib/
│       └── impl.cpp        # 库实现
├── lib/                     # 生成库文件位置（通过CMAKE_LIBRARY_OUTPUT_DIRECTORY设置）
└── bin/                     # 生成可执行文件位置（通过CMAKE_RUNTIME_OUTPUT_DIRECTORY设置）
</code></pre></div>
<h4 id="3-cmakecmakeliststxt">3. 现代CMake写法示例（CMakeLists.txt）</h4>
<div class="highlight"><pre><span></span><code><span class="nb">cmake_minimum_required</span><span class="p">(</span><span class="s">VERSION</span><span class="w"> </span><span class="s">3.15</span><span class="p">)</span>
<span class="nb">project</span><span class="p">(</span><span class="s">MyProject</span><span class="w"> </span><span class="s">VERSION</span><span class="w"> </span><span class="s">1.0.0</span><span class="w"> </span><span class="s">LANGUAGES</span><span class="w"> </span><span class="s">CXX</span><span class="p">)</span>

<span class="c"># 设置输出目录（与你的结构匹配）</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_ARCHIVE_OUTPUT_DIRECTORY</span><span class="w"> </span><span class="o">${</span><span class="nv">PROJECT_SOURCE_DIR</span><span class="o">}</span><span class="s">/lib</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_LIBRARY_OUTPUT_DIRECTORY</span><span class="w"> </span><span class="o">${</span><span class="nv">PROJECT_SOURCE_DIR</span><span class="o">}</span><span class="s">/lib</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_RUNTIME_OUTPUT_DIRECTORY</span><span class="w"> </span><span class="o">${</span><span class="nv">PROJECT_SOURCE_DIR</span><span class="o">}</span><span class="s">/bin</span><span class="p">)</span>

<span class="c"># 添加子目录（模块化构建）</span>
<span class="nb">add_subdirectory</span><span class="p">(</span><span class="s">src/mylib</span><span class="p">)</span><span class="w">  </span><span class="c"># 先构建库</span>
<span class="nb">add_subdirectory</span><span class="p">(</span><span class="s">src/app</span><span class="p">)</span><span class="w">    </span><span class="c"># 再构建可执行文件</span>
</code></pre></div>
<h4 id="4-target">4. 目标（Target）为中心的现代模式</h4>
<p><code>src/mylib/CMakeLists.txt</code>:
<div class="highlight"><pre><span></span><code><span class="nb">add_library</span><span class="p">(</span><span class="s">mylib</span><span class="w"> </span><span class="s">STATIC</span><span class="w"> </span><span class="s">impl.cpp</span><span class="p">)</span>
<span class="nb">target_include_directories</span><span class="p">(</span><span class="s">mylib</span><span class="w"> </span><span class="s">PUBLIC</span><span class="w"> </span>
<span class="w">    </span><span class="o">$&lt;</span><span class="nv">BUILD_INTERFACE:${PROJECT_SOURCE_DIR}/include</span><span class="o">&gt;</span>
<span class="w">    </span><span class="o">$&lt;</span><span class="nv">INSTALL_INTERFACE:include</span><span class="o">&gt;</span>
<span class="p">)</span>
</code></pre></div></p>
<p><code>src/app/CMakeLists.txt</code>:
<div class="highlight"><pre><span></span><code><span class="nb">add_executable</span><span class="p">(</span><span class="s">myapp</span><span class="w"> </span><span class="s">main.cpp</span><span class="p">)</span>
<span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">myapp</span><span class="w"> </span><span class="s">PRIVATE</span><span class="w"> </span><span class="s">mylib</span><span class="p">)</span><span class="w">  </span><span class="c"># 清晰声明依赖</span>
</code></pre></div></p>
<h4 id="5_1">5. 高级特性运用</h4>
<ul>
<li><strong>生成器表达式（Generator Expressions）</strong>：
  <div class="highlight"><pre><span></span><code><span class="nb">target_compile_options</span><span class="p">(</span><span class="s">mylib</span><span class="w"> </span><span class="s">PRIVATE</span><span class="w"> </span>
<span class="w">    </span><span class="o">$&lt;</span><span class="nv">$&lt;CXX_COMPILER_ID:MSVC</span><span class="o">&gt;</span><span class="s">:/W3&gt;</span>
<span class="w">    </span><span class="o">$&lt;</span><span class="nv">$&lt;CXX_COMPILER_ID:GNU,Clang</span><span class="o">&gt;</span><span class="s">:-Wall</span><span class="w"> </span><span class="s">-Wextra&gt;</span>
<span class="p">)</span>
</code></pre></div></li>
<li><strong>包管理集成</strong>：
  <div class="highlight"><pre><span></span><code><span class="nb">find_package</span><span class="p">(</span><span class="s">Boost</span><span class="w"> </span><span class="s">1.70</span><span class="w"> </span><span class="s">REQUIRED</span><span class="w"> </span><span class="s">COMPONENTS</span><span class="w"> </span><span class="s">filesystem</span><span class="p">)</span>
<span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">myapp</span><span class="w"> </span><span class="s">PRIVATE</span><span class="w"> </span><span class="s">Boost::filesystem</span><span class="p">)</span>
</code></pre></div></li>
</ul>
<h4 id="6">6. 跨平台最佳实践</h4>
<div class="highlight"><pre><span></span><code><span class="c"># 始终指定C++标准</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_CXX_STANDARD</span><span class="w"> </span><span class="s">17</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_CXX_STANDARD_REQUIRED</span><span class="w"> </span><span class="s">ON</span><span class="p">)</span>

<span class="c"># 处理Windows特定逻辑</span>
<span class="nb">if</span><span class="p">(</span><span class="s">WIN32</span><span class="p">)</span>
<span class="w">    </span><span class="nb">add_definitions</span><span class="p">(</span><span class="s">-D_WIN32_WINNT=0x0A00</span><span class="p">)</span>
<span class="w">    </span><span class="nb">target_sources</span><span class="p">(</span><span class="s">myapp</span><span class="w"> </span><span class="s">PRIVATE</span><span class="w"> </span><span class="s">platform/windows_compat.cpp</span><span class="p">)</span>
<span class="nb">endif</span><span class="p">()</span>
</code></pre></div>
<hr />
<h3 id="_29">四、专业开发者工作流</h3>
<ol>
<li><strong>版本控制集成</strong>：</li>
<li>在<code>.gitignore</code>中添加：
     <div class="highlight"><pre><span></span><code>build/
bin/
lib/
*.user
</code></pre></div></li>
<li><strong>CLI高级用法</strong>：
   <div class="highlight"><pre><span></span><code><span class="c1"># 生成Release版本</span>
cmake<span class="w"> </span>-DCMAKE_BUILD_TYPE<span class="o">=</span>Release<span class="w"> </span>-S<span class="w"> </span>.<span class="w"> </span>-B<span class="w"> </span>build/release
cmake<span class="w"> </span>--build<span class="w"> </span>build/release<span class="w"> </span>--parallel<span class="w"> </span><span class="m">8</span>

<span class="c1"># 生成Debug版本</span>
cmake<span class="w"> </span>-DCMAKE_BUILD_TYPE<span class="o">=</span>Debug<span class="w"> </span>-S<span class="w"> </span>.<span class="w"> </span>-B<span class="w"> </span>build/debug
</code></pre></div></li>
</ol>
<hr />
<h3 id="_30">五、学习路径推荐</h3>
<ol>
<li>官方文档：https://cmake.org/cmake/help/latest/</li>
<li>现代CMake教程：https://modern-cmake-cn.github.io/CMake-tutorial-zh-Hans/</li>
<li>进阶书籍：《Professional CMake: A Practical Guide》</li>
</ol>
<p>通过遵循这些实践，你将建立清晰的CMake项目结构，避免路径污染问题，并掌握企业级项目的构建系统管理能力。保持构建目录的纯净性和使用目标为中心的现代写法是成为CMake专家的关键。</p>
</blockquote>
<h3 id="_31">系统包安装路径</h3>
<p>做项目之前，先对整个项目进行源码的整体了解，知道哪里能查。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>head<span class="w"> </span>-n<span class="w"> </span><span class="m">1</span><span class="w"> </span>/etc/nv_tegra_release<span class="w">  </span>//查看jetpack版本（L4t<span class="w"> </span>Verion<span class="w"> </span>is<span class="w"> </span><span class="m">32</span>.6.1<span class="w"> </span>对应<span class="w"> </span>jetpack<span class="w"> </span><span class="m">4</span>.6）
<span class="c1"># R32 (release), REVISION: 6.1, GCID: 27863751, BOARD: t210ref, EABI: aarch64, DATE: Mon Jul 26 19:20:30 UTC 2021</span>
</code></pre></div>
<p>由BOARD: t210ref //查 https://repo.download.nvidia.com/jetson/  jetpack详细的支持功能包列表</p>
<p>看看这个包支持什么功能？</p>
<div class="highlight"><pre><span></span><code>jetson-gpio-common_2.0.17_arm64.deb
nvidia-container_4.6.1-b110_arm64.deb
nvidia-container_4.6.2-b5_arm64.deb
nvidia-container_4.6.3-b17_arm64.deb
nvidia-container_4.6.4-b39_arm64.deb
nvidia-container_4.6.5-b29_arm64.deb
nvidia-container_4.6.6-b24_arm64.deb
nvidia-cuda_4.6.1-b110_arm64.deb
nvidia-cuda_4.6.2-b5_arm64.deb
nvidia-cuda_4.6.3-b17_arm64.deb
nvidia-cuda_4.6.4-b39_arm64.deb
nvidia-cuda_4.6.5-b29_arm64.deb
nvidia-cuda_4.6.6-b24_arm64.deb
nvidia-cudnn8_4.6.1-b110_arm64.deb
nvidia-cudnn8_4.6.2-b5_arm64.deb
nvidia-cudnn8_4.6.3-b17_arm64.deb
nvidia-cudnn8_4.6.4-b39_arm64.deb
nvidia-cudnn8_4.6.5-b29_arm64.deb
nvidia-cudnn8_4.6.6-b24_arm64.deb
nvidia-jetpack_4.6.1-b110_arm64.deb
nvidia-jetpack_4.6.2-b5_arm64.deb
nvidia-jetpack_4.6.3-b17_arm64.deb
nvidia-jetpack_4.6.4-b39_arm64.deb
nvidia-jetpack_4.6.5-b29_arm64.deb
nvidia-jetpack_4.6.6-b24_arm64.deb
nvidia-l4t-3d-core_32.7.1-20220219090432_arm64.deb
nvidia-l4t-3d-core_32.7.2-20220420143418_arm64.deb
nvidia-l4t-3d-core_32.7.3-20221122092935_arm64.deb
nvidia-l4t-3d-core_32.7.4-20230608212426_arm64.deb
nvidia-l4t-3d-core_32.7.5-20240611161210_arm64.deb
nvidia-l4t-3d-core_32.7.6-20241104234540_arm64.deb
nvidia-l4t-apt-source_32.7.1-20220219090432_arm64.deb
nvidia-l4t-apt-source_32.7.2-20220420143418_arm64.deb
nvidia-l4t-apt-source_32.7.3-20221122092935_arm64.deb
nvidia-l4t-apt-source_32.7.4-20230608212426_arm64.deb
nvidia-l4t-apt-source_32.7.5-20240611161210_arm64.deb
nvidia-l4t-apt-source_32.7.6-20241104234540_arm64.deb
nvidia-l4t-bootloader_32.7.1-20220219090432_arm64.deb
nvidia-l4t-bootloader_32.7.2-20220420143418_arm64.deb
nvidia-l4t-bootloader_32.7.3-20221122092935_arm64.deb
nvidia-l4t-bootloader_32.7.4-20230608212426_arm64.deb
nvidia-l4t-bootloader_32.7.5-20240611161210_arm64.deb
nvidia-l4t-bootloader_32.7.6-20241104234540_arm64.deb
nvidia-l4t-camera_32.7.1-20220219090432_arm64.deb
nvidia-l4t-camera_32.7.2-20220420143418_arm64.deb
nvidia-l4t-camera_32.7.3-20221122092935_arm64.deb
nvidia-l4t-camera_32.7.4-20230608212426_arm64.deb
nvidia-l4t-camera_32.7.5-20240611161210_arm64.deb
nvidia-l4t-camera_32.7.6-20241104234540_arm64.deb
nvidia-l4t-configs_32.7.1-20220219090432_arm64.deb
nvidia-l4t-configs_32.7.2-20220420143418_arm64.deb
nvidia-l4t-configs_32.7.3-20221122092935_arm64.deb
nvidia-l4t-configs_32.7.4-20230608212426_arm64.deb
nvidia-l4t-configs_32.7.5-20240611161210_arm64.deb
nvidia-l4t-configs_32.7.6-20241104234540_arm64.deb
nvidia-l4t-core_32.7.1-20220219090432_arm64.deb
nvidia-l4t-core_32.7.2-20220420143418_arm64.deb
nvidia-l4t-core_32.7.3-20221122092935_arm64.deb
nvidia-l4t-core_32.7.4-20230608212426_arm64.deb
nvidia-l4t-core_32.7.5-20240611161210_arm64.deb
nvidia-l4t-core_32.7.6-20241104234540_arm64.deb
nvidia-l4t-cuda_32.7.1-20220219090432_arm64.deb
nvidia-l4t-cuda_32.7.2-20220420143418_arm64.deb
nvidia-l4t-cuda_32.7.3-20221122092935_arm64.deb
nvidia-l4t-cuda_32.7.4-20230608212426_arm64.deb
nvidia-l4t-cuda_32.7.5-20240611161210_arm64.deb
nvidia-l4t-cuda_32.7.6-20241104234540_arm64.deb
nvidia-l4t-firmware_32.7.1-20220219090432_arm64.deb
nvidia-l4t-firmware_32.7.2-20220420143418_arm64.deb
nvidia-l4t-firmware_32.7.3-20221122092935_arm64.deb
nvidia-l4t-firmware_32.7.4-20230608212426_arm64.deb
nvidia-l4t-firmware_32.7.5-20240611161210_arm64.deb
nvidia-l4t-firmware_32.7.6-20241104234540_arm64.deb
nvidia-l4t-gputools_32.7.1-20220219090432_arm64.deb
nvidia-l4t-gputools_32.7.2-20220420143418_arm64.deb
nvidia-l4t-gputools_32.7.3-20221122092935_arm64.deb
nvidia-l4t-gputools_32.7.4-20230608212426_arm64.deb
nvidia-l4t-gputools_32.7.5-20240611161210_arm64.deb
nvidia-l4t-gputools_32.7.6-20241104234540_arm64.deb
nvidia-l4t-graphics-demos_32.7.1-20220219090432_arm64.deb
nvidia-l4t-graphics-demos_32.7.2-20220420143418_arm64.deb
nvidia-l4t-graphics-demos_32.7.3-20221122092935_arm64.deb
nvidia-l4t-graphics-demos_32.7.4-20230608212426_arm64.deb
nvidia-l4t-graphics-demos_32.7.5-20240611161210_arm64.deb
nvidia-l4t-graphics-demos_32.7.6-20241104234540_arm64.deb
nvidia-l4t-gstreamer_32.7.1-20220219090432_arm64.deb
nvidia-l4t-gstreamer_32.7.2-20220420143418_arm64.deb
nvidia-l4t-gstreamer_32.7.3-20221122092935_arm64.deb
nvidia-l4t-gstreamer_32.7.4-20230608212426_arm64.deb
nvidia-l4t-gstreamer_32.7.5-20240611161210_arm64.deb
nvidia-l4t-gstreamer_32.7.6-20241104234540_arm64.deb
nvidia-l4t-init_32.7.1-20220219090432_arm64.deb
nvidia-l4t-init_32.7.2-20220420143418_arm64.deb
nvidia-l4t-init_32.7.3-20221122092935_arm64.deb
nvidia-l4t-init_32.7.4-20230608212426_arm64.deb
nvidia-l4t-init_32.7.5-20240611161210_arm64.deb
nvidia-l4t-init_32.7.6-20241104234540_arm64.deb
nvidia-l4t-initrd_32.7.1-20220219090432_arm64.deb
nvidia-l4t-initrd_32.7.2-20220420143418_arm64.deb
nvidia-l4t-initrd_32.7.3-20221122092935_arm64.deb
nvidia-l4t-initrd_32.7.4-20230608212426_arm64.deb
nvidia-l4t-initrd_32.7.5-20240611161210_arm64.deb
nvidia-l4t-initrd_32.7.6-20241104234540_arm64.deb
nvidia-l4t-jetson-io_32.7.1-20220219090432_arm64.deb
nvidia-l4t-jetson-io_32.7.2-20220420143418_arm64.deb
nvidia-l4t-jetson-io_32.7.3-20221122092935_arm64.deb
nvidia-l4t-jetson-io_32.7.4-20230608212426_arm64.deb
nvidia-l4t-jetson-io_32.7.5-20240611161210_arm64.deb
nvidia-l4t-jetson-io_32.7.6-20241104234540_arm64.deb
nvidia-l4t-jetson-multimedia-api_32.7.1-20220219090432_arm64.deb
nvidia-l4t-jetson-multimedia-api_32.7.2-20220420143418_arm64.deb
nvidia-l4t-jetson-multimedia-api_32.7.3-20221122092935_arm64.deb
nvidia-l4t-jetson-multimedia-api_32.7.4-20230608212426_arm64.deb
nvidia-l4t-jetson-multimedia-api_32.7.5-20240611161210_arm64.deb
nvidia-l4t-jetson-multimedia-api_32.7.6-20241104234540_arm64.deb
nvidia-l4t-kernel-dtbs_4.9.253-tegra-32.7.1-20220219090432_arm64.deb
nvidia-l4t-kernel-dtbs_4.9.253-tegra-32.7.2-20220420143418_arm64.deb
nvidia-l4t-kernel-dtbs_4.9.299-tegra-32.7.3-20221122092935_arm64.deb
nvidia-l4t-kernel-dtbs_4.9.337-tegra-32.7.4-20230608212426_arm64.deb
nvidia-l4t-kernel-dtbs_4.9.337-tegra-32.7.5-20240611161210_arm64.deb
nvidia-l4t-kernel-dtbs_4.9.337-tegra-32.7.6-20241104234540_arm64.deb
nvidia-l4t-kernel-headers_4.9.253-tegra-32.7.1-20220219090432_arm64.deb
nvidia-l4t-kernel-headers_4.9.253-tegra-32.7.2-20220420143418_arm64.deb
nvidia-l4t-kernel-headers_4.9.299-tegra-32.7.3-20221122092935_arm64.deb
nvidia-l4t-kernel-headers_4.9.337-tegra-32.7.4-20230608212426_arm64.deb
nvidia-l4t-kernel-headers_4.9.337-tegra-32.7.5-20240611161210_arm64.deb
nvidia-l4t-kernel-headers_4.9.337-tegra-32.7.6-20241104234540_arm64.deb
nvidia-l4t-kernel_4.9.253-tegra-32.7.1-20220219090432_arm64.deb
nvidia-l4t-kernel_4.9.253-tegra-32.7.2-20220420143418_arm64.deb
nvidia-l4t-kernel_4.9.299-tegra-32.7.3-20221122092935_arm64.deb
nvidia-l4t-kernel_4.9.337-tegra-32.7.4-20230608212426_arm64.deb
nvidia-l4t-kernel_4.9.337-tegra-32.7.5-20240611161210_arm64.deb
nvidia-l4t-kernel_4.9.337-tegra-32.7.6-20241104234540_arm64.deb
nvidia-l4t-libvulkan_32.7.1-20220219090432_arm64.deb
nvidia-l4t-libvulkan_32.7.2-20220420143418_arm64.deb
nvidia-l4t-libvulkan_32.7.3-20221122092935_arm64.deb
nvidia-l4t-libvulkan_32.7.4-20230608212426_arm64.deb
nvidia-l4t-libvulkan_32.7.5-20240611161210_arm64.deb
nvidia-l4t-libvulkan_32.7.6-20241104234540_arm64.deb
nvidia-l4t-multimedia-utils_32.7.1-20220219090432_arm64.deb
nvidia-l4t-multimedia-utils_32.7.2-20220420143418_arm64.deb
nvidia-l4t-multimedia-utils_32.7.3-20221122092935_arm64.deb
nvidia-l4t-multimedia-utils_32.7.4-20230608212426_arm64.deb
nvidia-l4t-multimedia-utils_32.7.5-20240611161210_arm64.deb
nvidia-l4t-multimedia-utils_32.7.6-20241104234540_arm64.deb
nvidia-l4t-multimedia_32.7.1-20220219090432_arm64.deb
nvidia-l4t-multimedia_32.7.2-20220420143418_arm64.deb
nvidia-l4t-multimedia_32.7.3-20221122092935_arm64.deb
nvidia-l4t-multimedia_32.7.4-20230608212426_arm64.deb
nvidia-l4t-multimedia_32.7.5-20240611161210_arm64.deb
nvidia-l4t-multimedia_32.7.6-20241104234540_arm64.deb
nvidia-l4t-oem-config_32.7.1-20220219090432_arm64.deb
nvidia-l4t-oem-config_32.7.2-20220420143418_arm64.deb
nvidia-l4t-oem-config_32.7.3-20221122092935_arm64.deb
nvidia-l4t-oem-config_32.7.4-20230608212426_arm64.deb
nvidia-l4t-oem-config_32.7.5-20240611161210_arm64.deb
nvidia-l4t-oem-config_32.7.6-20241104234540_arm64.deb
nvidia-l4t-tools_32.7.1-20220219090432_arm64.deb
nvidia-l4t-tools_32.7.2-20220420143418_arm64.deb
nvidia-l4t-tools_32.7.3-20221122092935_arm64.deb
nvidia-l4t-tools_32.7.4-20230608212426_arm64.deb
nvidia-l4t-tools_32.7.5-20240611161210_arm64.deb
nvidia-l4t-tools_32.7.6-20241104234540_arm64.deb
nvidia-l4t-wayland_32.7.1-20220219090432_arm64.deb
nvidia-l4t-wayland_32.7.2-20220420143418_arm64.deb
nvidia-l4t-wayland_32.7.3-20221122092935_arm64.deb
nvidia-l4t-wayland_32.7.4-20230608212426_arm64.deb
nvidia-l4t-wayland_32.7.5-20240611161210_arm64.deb
nvidia-l4t-wayland_32.7.6-20241104234540_arm64.deb
nvidia-l4t-weston_32.7.1-20220219090432_arm64.deb
nvidia-l4t-weston_32.7.2-20220420143418_arm64.deb
nvidia-l4t-weston_32.7.3-20221122092935_arm64.deb
nvidia-l4t-weston_32.7.4-20230608212426_arm64.deb
nvidia-l4t-weston_32.7.5-20240611161210_arm64.deb
nvidia-l4t-weston_32.7.6-20241104234540_arm64.deb
nvidia-l4t-x11_32.7.1-20220219090432_arm64.deb
nvidia-l4t-x11_32.7.2-20220420143418_arm64.deb
nvidia-l4t-x11_32.7.3-20221122092935_arm64.deb
nvidia-l4t-x11_32.7.4-20230608212426_arm64.deb
nvidia-l4t-x11_32.7.5-20240611161210_arm64.deb
nvidia-l4t-x11_32.7.6-20241104234540_arm64.deb
nvidia-l4t-xusb-firmware_32.7.1-20220219090432_arm64.deb
nvidia-l4t-xusb-firmware_32.7.2-20220420143418_arm64.deb
nvidia-l4t-xusb-firmware_32.7.3-20221122092935_arm64.deb
nvidia-l4t-xusb-firmware_32.7.4-20230608212426_arm64.deb
nvidia-l4t-xusb-firmware_32.7.5-20240611161210_arm64.deb
nvidia-l4t-xusb-firmware_32.7.6-20241104234540_arm64.deb
nvidia-nsight-sys_4.6.3-b17_arm64.deb
nvidia-nsight-sys_4.6.4-b39_arm64.deb
nvidia-nsight-sys_4.6.5-b29_arm64.deb
nvidia-nsight-sys_4.6.6-b24_arm64.deb
nvidia-opencv_4.6.1-b110_arm64.deb
nvidia-opencv_4.6.2-b5_arm64.deb
nvidia-opencv_4.6.3-b17_arm64.deb
nvidia-opencv_4.6.4-b39_arm64.deb
nvidia-opencv_4.6.5-b29_arm64.deb
nvidia-opencv_4.6.6-b24_arm64.deb
nvidia-tensorrt_4.6.1-b110_arm64.deb
nvidia-tensorrt_4.6.2-b5_arm64.deb
nvidia-tensorrt_4.6.3-b17_arm64.deb
nvidia-tensorrt_4.6.4-b39_arm64.deb
nvidia-tensorrt_4.6.5-b29_arm64.deb
nvidia-tensorrt_4.6.6-b24_arm64.deb
nvidia-visionworks_4.6.1-b110_arm64.deb
nvidia-visionworks_4.6.2-b5_arm64.deb
nvidia-visionworks_4.6.3-b17_arm64.deb
nvidia-visionworks_4.6.4-b39_arm64.deb
nvidia-visionworks_4.6.5-b29_arm64.deb
nvidia-visionworks_4.6.6-b24_arm64.deb
nvidia-vpi_4.6.1-b110_arm64.deb
nvidia-vpi_4.6.2-b5_arm64.deb
nvidia-vpi_4.6.3-b17_arm64.deb
nvidia-vpi_4.6.4-b39_arm64.deb
nvidia-vpi_4.6.5-b29_arm64.deb
nvidia-vpi_4.6.6-b24_arm64.deb
python-jetson-gpio_2.0.17_arm64.deb
python3-jetson-gpio_2.0.17_arm64.deb
</code></pre></div>
<p>知道有了包，安装在哪里？</p>
<p><code>dpkg -l | grep jetson-gpio</code></p>
<p>具体路径：<code>dpkg -L jetson-gpio-common</code>（将刚刚上面获得的名字输入）</p>
<p><img alt="image-20250324213255597" src="pic/image-20250324213255597.png" /></p>
<p>然后再去里面看看参考代码和文档</p>
<p>具体例子，编译某一个开源软件，编译移植过程中报错，可以深入到这里去看看，发现jetpack和某一个开源软件的API不匹配，比如少一个参数/多一个参数等等内容。</p>
<p>再来看看 <code>tensorRT</code>：</p>
<p>之前安装jetbot错误：</p>
<div class="highlight"><pre><span></span><code>$ sudo python3 setup.py install 
   //报错：ssd_tensorrt/FlattenConcat.cpp:277:58: error: invalid new-expression of abstract class type ‘FlattenConcat’
  // build.make:62: recipe for target    &#39;jetbot/ssd_tensorrt/CMakeFiles/ssd_tensorrt.dir/FlattenConcat.cpp.o&#39; failed
   //setuptools&gt;=42 is required for pyproject.toml configuration support
   //ERROR: setuptools==39.0.1 is used in combination with setuptools_scm&gt;=6.x

   //Your build configuration is incomplete and previously worked by accident!
注： 没精力查，可暂时跳过，但需记录，可能埋下雷，
</code></pre></div>
<p>怎么查？</p>
<p>就按上面的方式找到：</p>
<p><img alt="image-20250324214613945" src="pic/image-20250324214613945.png" /></p>
<p><img alt="image-20250324214626233" src="pic/image-20250324214626233.png" /></p>
<p>可能就是某个API改了，导致和开源软件使用的接口不一。</p>
<p>或者直接跳转？vscode帮忙做。</p>
<p><strong>但是上面这是通用的！如果有一些文件没找到，要么就是查找的内容不太对，要么就是真没有这个包！BSP还没做这个！</strong></p>
<p>再举个例子：内核：</p>
<p><img alt="image-20250324215107850" src="pic/image-20250324215107850.png" /></p>
<p>很多相关的驱动：网络、USB、PCIe。。。都是整个板子的驱动。。</p>
<p>再比如相关的设备树位置：</p>
<p><img alt="image-20250324215305128" src="pic/image-20250324215305128.png" /></p>
<p>有一个问题，相关的设备树文件，实际上没给的！！</p>
<p>确实很有用！！！</p>
<p>核心总结：<strong><mark>在大脑中建立这一款板子的架构图</mark></strong></p>
<h3 id="systemctl-linuxservice"><code>systemctl</code>: 管理Linux的服务的命令(替代<code>service</code>命令）</h3>
<p>动因：启动计算机需要启动很多服务，而传统service命令，runleve是串行启动 慢</p>
<p>而 <code>systemd</code> 采用target （unit组）方式，启动你一个target，里面的服务（unit）都会启动，而且可以并行启动。</p>
<blockquote>
<p>入门</p>
</blockquote>
<h4 id="_32">例子</h4>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>systemctl<span class="w"> </span>list-unit-files<span class="w"> </span>--type<span class="o">=</span>target<span class="w"> </span>//查看当前系统的所有Target
$<span class="w"> </span>systemctl<span class="w"> </span>get-default<span class="w">  </span>//查看默认上电启动的Tar<span class="o">(</span>如<span class="w"> </span>graphical.target<span class="o">)</span>
$<span class="w"> </span>systemctl<span class="w"> </span>list-dependencies<span class="w"> </span>multi-user.target<span class="w"> </span>//查看target中包含的服务<span class="o">(</span>unit<span class="o">)</span><span class="w">  </span>
<span class="w">              </span>//也可直接查看<span class="w"> </span>/etc/systemd/system/multi-user.target.wants<span class="w"> </span>文件夹<span class="w">          </span>
$<span class="w"> </span><span class="nb">cd</span><span class="w">    </span>/etc/systemd/system/<span class="w">  </span>
$<span class="w"> </span>ls<span class="w"> </span>-l<span class="w"> </span>default.target<span class="w">  </span>//开机时默认启动的服务
<span class="w">   </span>//default.target<span class="w"> </span>-&gt;<span class="w"> </span>/lib/systemd/system/graphical.target<span class="w">  </span>软链接到<span class="w"> </span>图形界面
<span class="w">   </span>//通常符号链接到graphical.target<span class="o">(</span>图形界面<span class="o">)</span>或者multi-user.target<span class="o">(</span>多用户命令行<span class="o">)</span><span class="w"> </span>
<span class="w">   </span>//可通过更改软连接方式，指定默认启动的服务
<span class="w">   </span>//比如：ln<span class="w"> </span>-s<span class="w"> </span>default.target<span class="w"> </span>multi-user.target<span class="w">   </span><span class="o">(</span>graphical.target<span class="o">)</span><span class="w"> </span>再查看systemctl<span class="w"> </span>get-default
<span class="w">   </span>//或通过命令<span class="w"> </span>$<span class="w"> </span>sudo<span class="w"> </span>systemctl<span class="w"> </span>set-default<span class="w"> </span>multi-user.target
</code></pre></div>
<p><img alt="image-20250324220754636" src="pic/image-20250324220754636.png" /></p>
<p><img alt="image-20250324220902345" src="pic/image-20250324220902345.png" /></p>
<p>比如要查看 <code>multi-user</code> 的服务：</p>
<p><img src="pic/image-20250324221203998.png" alt="image-20250324221203998" style="zoom: 67%;" /></p>
<p>再比如，如果你的蓝牙/声卡包括哪些服务，你的蓝牙/声卡驱动有什么问题：</p>
<p>列出所有的服务：<code>systemctl list-unit-files --type=target</code>，然后找到蓝牙</p>
<p><img alt="image-20250324221436637" src="pic/image-20250324221436637.png" /></p>
<p>声卡类似。</p>
<h4 id="_33">默认启动</h4>
<p>接着，如果要添加进默认启动的。<code>default.target</code></p>
<p>还有一个 <code>multi-user.target</code>，就是终端命令行的。</p>
<blockquote>
<p>计算机世界就是没有魔法的！！！</p>
</blockquote>
<p>再来深入看看默认启动的内容：</p>
<div class="highlight"><pre><span></span><code><span class="c1">//default.target   </span>
<span class="p">[</span><span class="n">Unit</span><span class="p">]</span>
<span class="n">Description</span><span class="o">=</span><span class="n">Graphical</span><span class="w"> </span><span class="n">Interface</span>
<span class="n">Documentation</span><span class="o">=</span><span class="n">man</span><span class="o">:</span><span class="n">systemd</span><span class="p">.</span><span class="n">special</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="n">Requires</span><span class="o">=</span><span class="n">multi</span><span class="o">-</span><span class="n">user</span><span class="p">.</span><span class="n">target</span><span class="w">  </span><span class="err">#</span><span class="c1">//强依赖(如果multi-user.target失败，本服务也失败退出)</span>
<span class="n">Wants</span><span class="o">=</span><span class="n">display</span><span class="o">-</span><span class="n">manager</span><span class="p">.</span><span class="n">service</span><span class="w"> </span><span class="err">#</span><span class="c1">//弱依赖(即display-manager.service失败，不影响本服务)</span>
<span class="n">Conflicts</span><span class="o">=</span><span class="n">rescue</span><span class="p">.</span><span class="n">service</span><span class="w"> </span><span class="n">rescue</span><span class="p">.</span><span class="n">target</span>

<span class="cp">#</span><span class="c1">//在multi-user.target ... 等服务之后，启动本服务</span>
<span class="n">After</span><span class="o">=</span><span class="n">multi</span><span class="o">-</span><span class="n">user</span><span class="p">.</span><span class="n">target</span><span class="w"> </span><span class="n">rescue</span><span class="p">.</span><span class="n">service</span><span class="w"> </span><span class="n">rescue</span><span class="p">.</span><span class="n">target</span><span class="w"> </span><span class="n">display</span><span class="o">-</span><span class="n">manager</span><span class="p">.</span><span class="n">service</span>
<span class="n">AllowIsolate</span><span class="o">=</span><span class="n">yes</span>
</code></pre></div>
<p>这里有一个 <code>requires</code> 依赖 ，强依赖(如果 <code>multi-user.target</code> 失败，本服务也失败退出)，还有一个弱依赖。</p>
<p>还有一个启动服务需要一些前置条件，那些也是服务！也就是启动该服务需要一些前提，必须要启动那些前提！</p>
<p><code>After=multi-user.target rescue.service rescue.target display-manager.service</code></p>
<p>还有，比如安装某一个开源软件的时候，没有启动某一个服务？？</p>
<p>比如：安装某一个开源软件的服务</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>systemctl<span class="w"> </span>list-unit-files<span class="w"> </span>--type<span class="o">=</span>target<span class="w"> </span>//查看当前系统的所有Target
$<span class="w"> </span>systemctl<span class="w"> </span>get-default<span class="w">  </span>//查看默认上电启动的Tar<span class="o">(</span>如<span class="w"> </span>graphical.target<span class="o">)</span>
$<span class="w"> </span>systemctl<span class="w"> </span>list-dependencies<span class="w"> </span>multi-user.target<span class="w"> </span>//查看target中包含的服务<span class="o">(</span>unit<span class="o">)</span><span class="w">  </span>

$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>jetbot/utils
$<span class="w"> </span>python3<span class="w"> </span>create_stats_service.py
$<span class="w"> </span>sudo<span class="w"> </span>mv<span class="w"> </span>jetbot_stats.service<span class="w"> </span>/etc/systemd/system/jetbot_stats.service
$<span class="w"> </span>sudo<span class="w"> </span>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>jetbot_stats<span class="w"> </span>//启动<span class="w"> </span>jetbot_stats<span class="w"> </span>服务
<span class="w">              </span>//systemctl:管理Linux的系统服务的命令<span class="o">(</span>替代service:<span class="w"> </span>串行启动<span class="w"> </span>慢）
$<span class="w"> </span>sudo<span class="w"> </span>systemctl<span class="w"> </span>start<span class="w"> </span>jetbot_stats
$<span class="w"> </span>python3<span class="w"> </span>create_jupyter_service.py
$<span class="w"> </span>sudo<span class="w"> </span>mv<span class="w"> </span>jetbot_jupyter.service<span class="w"> </span>/etc/systemd/system/jetbot_jupyter.service
$<span class="w"> </span>sudo<span class="w"> </span>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>jetbot_jupyter
$<span class="w"> </span>sudo<span class="w"> </span>systemctl<span class="w"> </span>start<span class="w"> </span>jetbot_jupyter<span class="w">   </span>
$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>..
$<span class="w"> </span>cp<span class="w"> </span>-rf<span class="w"> </span>notebooks/<span class="w"> </span>~/<span class="w">  </span>//拷贝jetbot的测试示例程序<span class="w"> </span>到主目录，方便使用
</code></pre></div>
<h4 id="_34">常用命令</h4>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>systemctl<span class="w"> </span>daemon-reload<span class="w">  </span>//重载系统服务
$<span class="w"> </span>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>*.service<span class="w">  </span>//设置开机启动某服务
$<span class="w"> </span>systemctl<span class="w"> </span>disable<span class="w"> </span>*.service<span class="w"> </span>//不开机启动某服务
$<span class="w"> </span>systemctl<span class="w"> </span>start<span class="w"> </span>*.service<span class="w">   </span>//立即启动服务
$<span class="w"> </span>systemctl<span class="w"> </span>stop<span class="w"> </span>*.service<span class="w">    </span>//停止服务
$<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>*.service<span class="w"> </span>//重启服务

$<span class="w"> </span>systemctl<span class="w"> </span>is-enabled<span class="w"> </span>nginx.service<span class="w"> </span>//查看服务是否开机启动
$<span class="w"> </span>systemctl<span class="w"> </span>list-unit-files<span class="p">|</span>grep<span class="w"> </span>enabled<span class="w"> </span>//查看已启动的服务列表：
$<span class="w"> </span>systemctl<span class="w"> </span>--failed<span class="w">     </span>//查看启动失败的服务列表
</code></pre></div>
<h3 id="jetbot_1"><code>jetbot</code> 源码分析</h3>
<ul>
<li>
<p><strong>1. 构建安装</strong></p>
<ul>
<li>
<p>源码安装</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>python3-smbus
$<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/NVIDIA-AI-IOT/jetbot<span class="w">  </span>//下载jetbot源码
$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>jetbot
$<span class="w"> </span>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>cmake
$<span class="w"> </span>sudo<span class="w"> </span>python3<span class="w"> </span>setup.py<span class="w"> </span>install<span class="w">   </span>-&gt;<span class="w">  </span>源码分析入口<span class="w"> </span>setup.py
<span class="w">       </span>//报错：ssd_tensorrt/FlattenConcat.cpp:277:58:<span class="w"> </span>error:<span class="w"> </span>invalid<span class="w"> </span>new-expression<span class="w"> </span>
</code></pre></div>
</li>
<li>
<p>安装 jetbot 服务 //添加自定义的系统服务</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>jetbot/utils
$<span class="w"> </span>python3<span class="w"> </span>create_stats_service.py<span class="w"> </span><span class="c1">#//生成 jetbot_stats.service 系统服务文件</span>
$<span class="w"> </span>sudo<span class="w"> </span>mv<span class="w"> </span>jetbot_stats.service<span class="w"> </span>/etc/systemd/system/jetbot_stats.service
$<span class="w"> </span>sudo<span class="w"> </span>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>jetbot_stats<span class="w"> </span>//开机自动激活<span class="w"> </span>
<span class="w">                                   </span>//jetbot_stats<span class="w"> </span>服务<span class="o">(</span>如oled屏显示状态如ip地址<span class="o">)</span>
$<span class="w"> </span>sudo<span class="w"> </span>systemctl<span class="w"> </span>start<span class="w"> </span>jetbot_stats<span class="w"> </span>//马上启动<span class="w"> </span>jetbot_stats<span class="w"> </span>服务
$<span class="w"> </span>python3<span class="w"> </span>create_jupyter_service.py
$<span class="w"> </span>sudo<span class="w"> </span>mv<span class="w"> </span>jetbot_jupyter.service<span class="w"> </span>/etc/systemd/system/jetbot_jupyter.service
//开机自动激活<span class="w"> </span>jetbot_jupyter<span class="w"> </span>服务<span class="o">(</span>如浏览器jupter能访问<span class="o">)</span>
$<span class="w"> </span>sudo<span class="w"> </span>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>jetbot_jupyter
$<span class="w"> </span>sudo<span class="w"> </span>systemctl<span class="w"> </span>start<span class="w"> </span>jetbot_jupyter<span class="w">   </span>
$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>..
$<span class="w"> </span>cp<span class="w"> </span>-rf<span class="w"> </span>notebook
</code></pre></div>
</li>
<li>
<p>安装脚本</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">glob</span>  <span class="c1">#//文件搜索库</span>
<span class="kn">import</span> <span class="nn">subprocess</span> <span class="c1">#//可创建子进程并与之通讯，如运行系统命令 (替换老的os.system())</span>
               <span class="c1">#//相比os.system它不运行shell,更安全灵活速度快</span>
<span class="kn">from</span> <span class="nn">setuptools</span> <span class="kn">import</span> <span class="n">setup</span><span class="p">,</span> <span class="n">find_packages</span><span class="p">,</span> <span class="n">Extension</span> <span class="c1">#//setuptools 是创建和分发Python包的工具</span>

<span class="k">def</span> <span class="nf">build_libs</span><span class="p">():</span>
    <span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">([</span><span class="s1">&#39;cmake&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">])</span> <span class="c1">#//类似 os.sysem(&quot;cmake .&quot;) -&gt; 触发CMakeLists.txt执行</span>
    <span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">([</span><span class="s1">&#39;make&#39;</span><span class="p">])</span>

<span class="n">build_libs</span><span class="p">()</span>
<span class="n">setup</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;jetbot&#39;</span><span class="p">,</span> <span class="c1">#//包名: 生成 python(蟒蛇)扩展包egg(蛋)的名字</span>
    <span class="n">version</span><span class="o">=</span><span class="s1">&#39;0.4.3&#39;</span><span class="p">,</span><span class="c1">#//包版本号</span>
    <span class="n">description</span><span class="o">=</span><span class="s1">&#39;An open-source robot based on NVIDIA Jetson Nano&#39;</span><span class="p">,</span>
    <span class="n">packages</span><span class="o">=</span><span class="n">find_packages</span><span class="p">(),</span>
    <span class="n">install_requires</span><span class="o">=</span><span class="p">[</span> <span class="c1">#//安装该扩展包，需要的第三方包</span>
        <span class="s1">&#39;Adafruit_MotorHat&#39;</span><span class="p">,</span> <span class="c1">#//树莓派电机驱动模块(控制小车马达) </span>
        <span class="s1">&#39;Adafruit-SSD1306&#39;</span><span class="p">,</span> <span class="c1">#//树莓派针对SSD1306这款OLED屏幕的显示图形库</span>
    <span class="p">],</span>
    <span class="n">package_data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;jetbot&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;ssd_tensorrt/*.so&#39;</span><span class="p">]},</span> <span class="c1">#//把*.so等文件打包进包里</span>
<span class="p">)</span>   
</code></pre></div>
</li>
<li>
<p>构建配置文件</p>
<p>CMakeLists.txt</p>
<div class="highlight"><pre><span></span><code>cmake_minimum_required(VERSION 3.1)  #// cmake的最低版本要求是3.1，我们安装的是3.10.2
project(ssd_tensorrt) #//工程名
find_package(CUDA REQUIRED) #//查找外部库
                            #//查找路径  /usr/share/cmake-3.10/Modules/FindCUDA.cmake
include_directories(${CUDA_INCLUDE_DIRS}) #//指定搜索cuda头文件的路径
                      #//CUDA_INCLUDE_DIRS的定义 见/usr/share/cmake-3.10/Modules/FindCUDA.cmake里
                      #//的set (CUDA_INCLUDE_DIRS ${CUDA_TOOLKIT_INCLUDE}) 
message(&quot;${CUDA_INCLUDE_DIRS}&quot;)  #//添加调试信息，查看 环境变量内容：                     
link_directories(${CUDA_TOOLKIT_ROOT_DIR}/lib64)
add_subdirectory(jetbot)  #//进入jetbot目录，解析子 CMakeLists.txt
</code></pre></div>
<p>jetbot/CMakeLists.txt</p>
<div class="highlight"><pre><span></span><code>add_subdirectory(ssd_tensorrt)  #//进入ssd_tensorrt目录，解析子 CMakeLists.txt
</code></pre></div>
<p>ssd_tensorrt/</p>
<div class="highlight"><pre><span></span><code>add_library(ssd_tensorrt SHARED FlattenConcat.cpp) #//生成共享库 ssd_tensorrt
target_link_libraries(ssd_tensorrt nvinfer cublas) #//把nvinfer cublas 链接到ssd_tensorrt中
</code></pre></div>
</li>
<li>
<p>生成系统服务文件</p>
<p>jetbot/utils/create_stats_service.py  </p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">import</span> <span class="nn">getpass</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="c1">#Linux 服务的配置</span>
<span class="n">STATS_SERVICE_TEMPLATE</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;  </span>
<span class="s2">[Unit]</span>
<span class="s2">Description=JetBot stats display service   #当前服务的描述</span>

<span class="s2">[Service]</span>
<span class="s2">Type=simple</span>
<span class="s2">User=</span><span class="si">%s</span>
<span class="s2">ExecStart=/bin/sh -c &quot;python3 -m jetbot.apps.stats&quot; #//启动服务时执行的指令(OLED屏显示)</span>
<span class="s2">WorkingDirectory=</span><span class="si">%s</span>
<span class="s2">Restart=always</span>

<span class="s2">[Install]   </span>
<span class="s2">WantedBy=multi-user.target  #//安装本服务(unit)到 multi-user.target 中</span>
<span class="s2">                       #//当multi-user.target启动时，该服务也就启动了</span>
<span class="s2">                       #//默认启动的target见 /etc/systemd/system/default.target </span>

<span class="s2">&quot;&quot;&quot;</span>
<span class="n">STATS_SERVICE_NAME</span> <span class="o">=</span> <span class="s1">&#39;jetbot_stats&#39;</span>  <span class="c1">#当前服务的名字</span>
<span class="k">def</span> <span class="nf">get_stats_service</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">STATS_SERVICE_TEMPLATE</span> <span class="o">%</span> <span class="p">(</span><span class="n">getpass</span><span class="o">.</span><span class="n">getuser</span><span class="p">(),</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;HOME&#39;</span><span class="p">])</span>

<span class="c1">#在当前目录下生成 jetbot_stats.service 文件</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--output&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;jetbot_stats.service&#39;</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">get_stats_service</span><span class="p">())</span>    
</code></pre></div>
</li>
</ul>
</li>
<li>
<p><strong>2. 应用访问</strong></p>
<p>动因：Python是如何访问内核驱动的 从而控制硬件的(如马达，oled屏等)</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>/usr/local/lib/python3.6/dist-packages/<span class="w">   </span>//python包的安装位置
//未解压的egg包，vscode不能源码跳转，故手动解压，解压重启vscode<span class="w"> </span>即可跳转跟踪
$<span class="w"> </span>sudo<span class="w"> </span>unzip<span class="w">    </span>Adafruit_GPIO-1.0.3-py3.6.egg<span class="w">  </span>
$<span class="w"> </span>sudo<span class="w"> </span>unzip<span class="w">    </span>Adafruit_PureIO-1.1.9-py3.6.egg
$<span class="w"> </span>sudo<span class="w"> </span>unzip<span class="w">  </span>Adafruit_SSD1306-1.6.2-py3.6.egg
</code></pre></div>
<ul>
<li>
<p>小车电机控制</p>
<p>notebooks/basic_motion/basic_motion.ipynb</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">jetbot</span> <span class="kn">import</span> <span class="n">Robot</span>  
<span class="n">robot</span> <span class="o">=</span> <span class="n">Robot</span><span class="p">()</span> 
<span class="n">robot</span><span class="o">.</span><span class="n">left</span><span class="p">(</span><span class="n">speed</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>   <span class="o">//</span> <span class="o">-&gt;</span> <span class="n">见jetbot</span><span class="o">/</span><span class="n">robot</span><span class="o">.</span><span class="n">py</span> 
<span class="n">robot</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</code></pre></div>
<p>jetbot/robot.py  用vscode跟踪</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Robot</span><span class="p">(</span><span class="n">SingletonConfigurable</span><span class="p">):</span>   
    <span class="n">left_motor</span> <span class="o">=</span> <span class="n">traitlets</span><span class="o">.</span><span class="n">Instance</span><span class="p">(</span><span class="n">Motor</span><span class="p">)</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Robot</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1">#//-&gt; Adafruit_MotorHAT/Adafruit_MotorHAT_Motors.py        </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">motor_driver</span> <span class="o">=</span> <span class="n">Adafruit_MotorHAT</span><span class="p">(</span><span class="n">i2c_bus</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">i2c_bus</span><span class="p">)</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">left_motor</span> <span class="o">=</span> <span class="n">Motor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">motor_driver</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">left_motor_channel</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">left_motor_alpha</span><span class="p">)</span> <span class="c1">#//-&gt; jetbot/motor.py</span>

    <span class="k">def</span> <span class="nf">left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">speed</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">left_motor</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="o">-</span><span class="n">speed</span>  <span class="c1">#//-&gt; jetbot/motor.py的_write_value</span>
</code></pre></div>
<p>jetbot/motor.py</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Motor</span><span class="p">(</span><span class="n">Configurable</span><span class="p">):</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">traitlets</span><span class="o">.</span><span class="n">Float</span><span class="p">()</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">driver</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Motor</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>  <span class="c1"># initializes traitlets      </span>
    <span class="nd">@traitlets</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_observe_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">change</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_value</span><span class="p">(</span><span class="n">change</span><span class="p">[</span><span class="s1">&#39;new&#39;</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">_write_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets motor value between [-1, 1]&quot;&quot;&quot;</span>
        <span class="n">mapped_value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">255.0</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">*</span> <span class="n">value</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">))</span>
        <span class="n">speed</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">mapped_value</span><span class="p">),</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">255</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_motor</span><span class="o">.</span><span class="n">setSpeed</span><span class="p">(</span><span class="n">speed</span><span class="p">)</span>  
</code></pre></div>
</li>
<li>
<p>树莓派 python 库</p>
<p>Adafruit_MotorHAT/Adafruit_MotorHAT_Motors.py</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Adafruit_MotorHAT</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addr</span> <span class="o">=</span> <span class="mh">0x60</span><span class="p">,</span> <span class="n">freq</span> <span class="o">=</span> <span class="mi">1600</span><span class="p">,</span> <span class="n">i2c</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">i2c_bus</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_frequency</span> <span class="o">=</span> <span class="n">freq</span>
        <span class="c1">#//通过pwm脉冲宽度调制，控制电机速度</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pwm</span> <span class="o">=</span> <span class="n">PWM</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">i2c</span><span class="o">=</span><span class="n">i2c</span><span class="p">,</span> <span class="n">i2c_bus</span><span class="o">=</span><span class="n">i2c_bus</span><span class="p">)</span> 
        <span class="c1">#//-&gt;Adafruit_MotorHAT/Adafruit_PWM_Servo_Driver.py</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pwm</span><span class="o">.</span><span class="n">setPWMFreq</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_frequency</span><span class="p">)</span> 
</code></pre></div>
<p>Adafruit_MotorHAT/Adafruit_PWM_Servo_Driver.py</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">PWM</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="o">=</span><span class="mh">0x40</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">i2c</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">i2c_bus</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">i2c</span> <span class="o">=</span> <span class="n">get_i2c_device</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">i2c</span><span class="p">,</span> <span class="n">i2c_bus</span><span class="p">)</span>   
    <span class="k">def</span> <span class="nf">setPWMFreq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">freq</span><span class="p">):</span>
        <span class="s2">&quot;Sets the PWM frequency&quot;</span>
        <span class="n">prescaleval</span> <span class="o">=</span> <span class="mf">25000000.0</span>    <span class="c1"># 25MHz</span>
        <span class="n">prescaleval</span> <span class="o">/=</span> <span class="nb">float</span><span class="p">(</span><span class="n">freq</span><span class="p">)</span>
        <span class="c1">#//-&gt; Adafruit_GPIO/I2C.py</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">i2c</span><span class="o">.</span><span class="n">write8</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__PRESCALE</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">prescale</span><span class="p">)))</span>  
</code></pre></div>
<p>Adafruit_GPIO/I2C.py</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Device</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">busnum</span><span class="p">,</span> <span class="n">i2c_interface</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_address</span> <span class="o">=</span> <span class="n">address</span>
        <span class="k">if</span> <span class="n">i2c_interface</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">Adafruit_PureIO.smbus</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_bus</span> <span class="o">=</span> <span class="n">Adafruit_PureIO</span><span class="o">.</span><span class="n">smbus</span><span class="o">.</span><span class="n">SMBus</span><span class="p">(</span><span class="n">busnum</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">write8</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">register</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Write an 8-bit value to the specified register.&quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
        <span class="c1">#// -&gt; Adafruit_PureIO/smbus.py</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bus</span><span class="o">.</span><span class="n">write_byte_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_address</span><span class="p">,</span> <span class="n">register</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> 
</code></pre></div>
<p>Adafruit_PureIO/smbus.py</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">SMBus</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bus</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_device</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">bus</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">bus</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bus</span><span class="p">):</span>
        <span class="o">//-&gt;</span> <span class="n">对应内核驱动</span> <span class="n">的设备文件的操作</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_device</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;/dev/i2c-</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bus</span><span class="p">),</span> <span class="s2">&quot;r+b&quot;</span><span class="p">,</span> <span class="n">buffering</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  

    <span class="k">def</span> <span class="nf">write_byte_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">cmd</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">cmd</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
        <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
        <span class="c1"># Send the data to the device.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_select_device</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_device</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>      <span class="o">//</span> <span class="n">对应内核驱动的设备文件的写</span> 
</code></pre></div>
</li>
<li>
<p>OLED 控制</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>jetbot_stats<span class="w"> </span>//前面构建时已自启动该服务<span class="w"> </span>
$<span class="w"> </span>cat<span class="w"> </span>jetbot_stats.service
<span class="w"> </span>//服务启动时运行<span class="w"> </span>jetbot目录下apps目录下stats<span class="w"> </span>模型<span class="o">(</span>即stats.py脚本<span class="o">)</span>
<span class="w"> </span><span class="nv">ExecStart</span><span class="o">=</span>/bin/sh<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;python3 -m jetbot.apps.stats&quot;</span>
</code></pre></div>
<p>jetbot/jetbot/apps/stats.py</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">Adafruit_SSD1306</span>
<span class="kn">from</span> <span class="nn">jetbot.utils.utils</span> <span class="kn">import</span> <span class="n">get_ip_address</span>
<span class="kn">import</span> <span class="nn">subprocess</span>

<span class="c1">#//树莓派SSD1306 oled屏的图形库驱动(基于I2C)</span>
<span class="n">disp</span> <span class="o">=</span> <span class="n">Adafruit_SSD1306</span><span class="o">.</span><span class="n">SSD1306_128_32</span><span class="p">(</span><span class="n">rst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">i2c_bus</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">gpio</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 

<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">draw</span><span class="o">.</span><span class="n">rectangle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">width</span><span class="p">,</span><span class="n">height</span><span class="p">),</span> <span class="n">outline</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&quot;top -bn1 | grep load | awk &#39;{printf </span><span class="se">\&quot;</span><span class="s2">CPU Load: </span><span class="si">%.2f</span><span class="se">\&quot;</span><span class="s2">, $(NF-2)}&#39;&quot;</span>
    <span class="n">CPU</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">check_output</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">shell</span> <span class="o">=</span> <span class="kc">True</span> <span class="p">)</span> <span class="c1">#//cpu使用情况</span>
    <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&quot;free -m | awk &#39;NR==2{printf </span><span class="se">\&quot;</span><span class="s2">Mem: </span><span class="si">%s</span><span class="s2">/</span><span class="si">%s</span><span class="s2">MB </span><span class="si">%.2f%%</span><span class="se">\&quot;</span><span class="s2">, $3,$2,$3*100/$2 }&#39;&quot;</span>
    <span class="n">MemUsage</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">check_output</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">shell</span> <span class="o">=</span> <span class="kc">True</span> <span class="p">)</span> <span class="c1">#//内存使用情况</span>
    <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&quot;df -h | awk &#39;$NF==</span><span class="se">\&quot;</span><span class="s2">/</span><span class="se">\&quot;</span><span class="s2">{printf </span><span class="se">\&quot;</span><span class="s2">Disk: </span><span class="si">%d</span><span class="s2">/</span><span class="si">%d</span><span class="s2">GB </span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">, $3,$2,$5}&#39;&quot;</span>
    <span class="n">Disk</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">check_output</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">shell</span> <span class="o">=</span> <span class="kc">True</span> <span class="p">)</span>  <span class="c1">#//硬盘使用情况</span>
    <span class="c1">#//显示ip地址，内存和硬盘使用情况</span>
    <span class="n">draw</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">top</span><span class="p">),</span>       <span class="s2">&quot;eth0: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">get_ip_address</span><span class="p">(</span><span class="s1">&#39;eth0&#39;</span><span class="p">)),</span>  <span class="n">font</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
    <span class="n">draw</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">top</span><span class="o">+</span><span class="mi">8</span><span class="p">),</span>     <span class="s2">&quot;wlan0: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">get_ip_address</span><span class="p">(</span><span class="s1">&#39;wlan0&#39;</span><span class="p">)),</span> <span class="n">font</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
    <span class="n">draw</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">top</span><span class="o">+</span><span class="mi">16</span><span class="p">),</span>    <span class="nb">str</span><span class="p">(</span><span class="n">MemUsage</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)),</span>  <span class="n">font</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
    <span class="n">draw</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">top</span><span class="o">+</span><span class="mi">25</span><span class="p">),</span>    <span class="nb">str</span><span class="p">(</span><span class="n">Disk</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)),</span>  <span class="n">font</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
    <span class="n">disp</span><span class="o">.</span><span class="n">image</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
    <span class="n">disp</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>   
</code></pre></div>
</li>
<li>
<p>OLED 屏测试</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">time</span>

<span class="kn">import</span> <span class="nn">Adafruit_SSD1306</span>

<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">ImageDraw</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">ImageFont</span>

<span class="c1"># 128x32 display with hardware I2C:</span>
<span class="n">disp</span> <span class="o">=</span> <span class="n">Adafruit_SSD1306</span><span class="o">.</span><span class="n">SSD1306_128_32</span><span class="p">(</span><span class="n">rst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">i2c_bus</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">gpio</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># setting gpio to 1 is hack to avoid platform detection</span>

<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>

 <span class="k">try</span><span class="p">:</span>
 <span class="c1"># Try to connect to the OLED display module via I2C.</span>
 <span class="n">disp</span><span class="o">.</span><span class="n">begin</span><span class="p">()</span>
 <span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
 <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;OS error: </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
 <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
 <span class="k">else</span><span class="p">:</span>
 <span class="k">break</span>

<span class="c1"># Clear display.</span>
<span class="n">disp</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="n">disp</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>

<span class="c1"># Create blank image for drawing.</span>
<span class="c1"># Make sure to create image with mode &#39;1&#39; for 1-bit color.</span>
<span class="n">width</span> <span class="o">=</span> <span class="n">disp</span><span class="o">.</span><span class="n">width</span>
<span class="n">height</span> <span class="o">=</span> <span class="n">disp</span><span class="o">.</span><span class="n">height</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">))</span>

<span class="c1"># Get drawing object to draw on image.</span>
<span class="n">draw</span> <span class="o">=</span> <span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>

<span class="c1"># Draw a black filled box to clear the image.</span>
<span class="n">draw</span><span class="o">.</span><span class="n">rectangle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">width</span><span class="p">,</span><span class="n">height</span><span class="p">),</span> <span class="n">outline</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Draw some shapes.</span>
<span class="c1"># First define some constants to allow easy resizing of shapes.</span>
<span class="n">padding</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
<span class="n">top</span> <span class="o">=</span> <span class="n">padding</span>
<span class="n">bottom</span> <span class="o">=</span> <span class="n">height</span><span class="o">-</span><span class="n">padding</span>
<span class="c1"># Move left to right keeping track of the current x position for drawing shapes.</span>
<span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># Load default font.</span>
<span class="n">font</span> <span class="o">=</span> <span class="n">ImageFont</span><span class="o">.</span><span class="n">load_default</span><span class="p">()</span>


<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>

 <span class="c1"># Draw a black filled box to clear the image.</span>
 <span class="n">draw</span><span class="o">.</span><span class="n">rectangle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">width</span><span class="p">,</span><span class="n">height</span><span class="p">),</span> <span class="n">outline</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

 <span class="n">draw</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">top</span><span class="p">),</span>       <span class="s2">&quot;hello oled &quot;</span> <span class="p">,</span>  <span class="n">font</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>

 <span class="c1"># Display image.</span>
 <span class="n">disp</span><span class="o">.</span><span class="n">image</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
 <span class="n">disp</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
 <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
</li>
</ul>
</li>
<li>
<p><strong>3. 内核驱动</strong></p>
</li>
<li>
<p><strong>4. 硬件</strong></p>
</li>
</ul>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2025-03-26T07:48:07+01:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2025-03-26</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2025-03-26T07:48:07+01:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2025-03-26</span>
  </span>

    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/JAILuo" target="_blank" rel="noopener" title="JAILuo" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.footer"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../../js/timeago.min.js"></script>
      
        <script src="../../js/timeago_mkdocs_material.js"></script>
      
        <script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
      
    
  </body>
</html>